{"id":"clack-068","title":"Task 2.1: Create model tier configuration","description":"Create src/config/model-tiers.ts with MODEL_TIERS mapping for OpenAI (gpt-4o-mini, gpt-4o, gpt-4-turbo) and Anthropic (haiku, sonnet, opus) providers.","acceptance_criteria":"- MODEL_TIERS constant with openai and anthropic mappings\n- Light/medium/heavy tiers for each provider\n- Type-safe configuration object\n- Exported for use by ModelTierSelector","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-26T22:15:11.153157421Z","updated_at":"2025-11-26T23:26:00.797444305Z","closed_at":"2025-11-26T23:26:00.797444305Z","dependencies":[{"issue_id":"clack-068","depends_on_id":"clack-adr","type":"parent-child","created_at":"2025-11-26T22:15:18.610543299Z","created_by":"daemon"}]}
{"id":"clack-0dd","title":"Task 4.4: Create registerNotifications function","description":"Create src/content/registry/register-notifications.ts to register P0 Home Assistant notification generators dynamically.","acceptance_criteria":"- Creates notification generators for common HA events\n- Door opened, person arrived, motion detected patterns\n- Each with eventTriggerPattern regex\n- P0 priority setting","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T22:16:06.411475877Z","updated_at":"2025-11-27T04:11:32.205020012Z","closed_at":"2025-11-27T04:11:32.205020012Z","dependencies":[{"issue_id":"clack-0dd","depends_on_id":"clack-4lg","type":"parent-child","created_at":"2025-11-26T22:16:15.480507673Z","created_by":"daemon"},{"issue_id":"clack-0dd","depends_on_id":"clack-2tg","type":"blocks","created_at":"2025-11-26T22:16:15.931242131Z","created_by":"daemon"}]}
{"id":"clack-0nr","title":"Home Assistant Core Client Implementation","description":"Implement the WebSocket client for Home Assistant communication with connection management, event subscriptions, and helper methods.","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-11-24T00:14:50.431430209Z","updated_at":"2025-11-24T07:03:55.427117469Z","closed_at":"2025-11-24T07:03:55.427117469Z"}
{"id":"clack-102","title":"Fix orchestrator-data-provider.test.ts - generateWithRetry mock returns undefined","description":"The mock generateWithRetry function returns undefined instead of GeneratedContent, causing content.outputMode to fail.\n\n**Failures:** 5 tests\n- should call dataProvider.fetchData() before generation on major updates\n- should skip dataProvider.fetchData() on minor updates\n- should work without dataProvider for backward compatibility\n- should pass pre-fetched weather data to FrameDecorator\n- should continue with null data if dataProvider.fetchData() fails\n\n**Fix:** Review mock setup order and ensure generateWithRetry mock is properly configured.\n\n**Files:** tests/unit/content/orchestrator-data-provider.test.ts","status":"open","priority":1,"issue_type":"bug","created_at":"2025-11-28T02:24:25.141950887Z","updated_at":"2025-11-28T02:24:25.141950887Z"}
{"id":"clack-1h3","title":"Install Dependencies","description":"Install home-assistant-js-websocket, ws package for Node.js WebSocket support, and @types/ws as dev dependency. Update package.json with proper version constraints.","acceptance_criteria":"- home-assistant-js-websocket installed\n- ws package installed\n- @types/ws dev dependency installed\n- package.json updated with version constraints","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-24T00:16:18.852391333Z","updated_at":"2025-11-24T05:09:52.454618426Z","closed_at":"2025-11-24T05:09:52.454618426Z","dependencies":[{"issue_id":"clack-1h3","depends_on_id":"clack-0nr","type":"parent-child","created_at":"2025-11-24T04:18:46.558407216Z","created_by":"vscode"}]}
{"id":"clack-1ls","title":"Create CLI Testing Tool","description":"Create src/cli/commands/test-ha.ts with commands to test connection, list entities, and subscribe to events.","acceptance_criteria":"- CLI tool file created\n- Test connection command\n- Validate authentication\n- --list option (list all entities)\n- --entity option (get specific state)\n- --watch option (subscribe to event for 30s)\n- Added to commander index\n- npm script added (test:ha)\n- Colored output for success/failure\n- Error diagnostics","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T00:18:58.84187713Z","updated_at":"2025-11-24T08:56:03.992195055Z","closed_at":"2025-11-24T08:56:03.992195055Z","dependencies":[{"issue_id":"clack-1ls","depends_on_id":"clack-ar9","type":"blocks","created_at":"2025-11-24T00:20:12.412759094Z","created_by":"daemon"},{"issue_id":"clack-1ls","depends_on_id":"clack-2w5","type":"blocks","created_at":"2025-11-24T00:20:13.594353095Z","created_by":"daemon"},{"issue_id":"clack-1ls","depends_on_id":"clack-y4k","type":"blocks","created_at":"2025-11-24T00:20:14.812887679Z","created_by":"daemon"},{"issue_id":"clack-1ls","depends_on_id":"clack-926","type":"parent-child","created_at":"2025-11-24T04:20:33.152792459Z","created_by":"vscode"}]}
{"id":"clack-1wi","title":"Implement Service Call Method","description":"Implement callService(domain, service, data) method with parameter validation and error handling.","acceptance_criteria":"- callService(domain, service, data) method\n- Parameter validation\n- Service call error handling\n- Service call response return\n- Error types for common failures","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T00:18:47.44143118Z","updated_at":"2025-11-24T05:56:37.914826711Z","closed_at":"2025-11-24T05:56:37.914826711Z","dependencies":[{"issue_id":"clack-1wi","depends_on_id":"clack-ar9","type":"blocks","created_at":"2025-11-24T00:19:56.547744003Z","created_by":"daemon"},{"issue_id":"clack-1wi","depends_on_id":"clack-4qv","type":"blocks","created_at":"2025-11-24T00:19:57.852601504Z","created_by":"daemon"},{"issue_id":"clack-1wi","depends_on_id":"clack-0nr","type":"parent-child","created_at":"2025-11-24T04:19:12.141776714Z","created_by":"vscode"}]}
{"id":"clack-201","title":"Test isolation failure: env.test.ts loads real .env file","description":"Environment configuration tests fail due to test isolation issues where the real .env file is loaded during test execution, overriding mocked environment variables.\n\nROOT CAUSE:\nThe src/config/env.ts module executes dotenv.config() at module initialization (lines 2-3):\n```typescript\nimport dotenv from 'dotenv';\ndotenv.config({ override: true });\n```\n\nWhen tests use require('@/config/env') to reload the module for test isolation, this code re-executes and loads the actual .env file from the repository, overriding test-mocked environment variables.\n\nIMPACT:\n- 16 out of 48 tests in tests/unit/config/env.test.ts fail\n- Tests cannot properly verify validation logic for missing required variables\n- Tests cannot verify default values because real values override them\n- Tests cannot verify error handling because real credentials succeed\n\nFAILING TESTS:\n- \"should throw error when VESTABOARD_LOCAL_API_KEY is missing\" - loads real key\n- \"should use default AI_PROVIDER as openai\" - gets \"anthropic\" from .env\n- \"should use default OPENAI_MODEL\" - gets undefined (Anthropic provider active)\n- And 13 more tests with similar isolation issues\n\nEXPECTED BEHAVIOR:\nTests should execute in complete isolation with only mocked environment variables, allowing validation of error conditions, defaults, and edge cases.\n\nDISCOVERED DURING:\nTask clack-n94 (Home Assistant configuration) - all new HA tests pass, but existing test suite failures revealed during quality gate validation.","design":"SOLUTION OPTIONS:\n\n1. **Lazy initialization** (Recommended):\n   - Move dotenv.config() call into loadConfig() function\n   - Only execute on first call\n   - Tests can mock process.env before calling loadConfig()\n\n2. **Test-aware configuration**:\n   - Check NODE_ENV === 'test' and skip dotenv in tests\n   - Tests explicitly control environment\n\n3. **Mock dotenv module**:\n   - Already attempted (line 5: jest.mock('dotenv/config'))\n   - Not effective because dotenv is imported directly\n\n4. **Separate test configuration module**:\n   - Create test-specific config loader\n   - More overhead but complete isolation","acceptance_criteria":"- All 48 tests in env.test.ts pass with proper isolation\n- No real .env file values leak into test execution\n- Tests can properly verify missing variable errors\n- Tests can properly verify default values\n- jest.resetModules() properly clears config cache\n- Coverage for src/config/env.ts reaches 80%+ branch coverage","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-11-24T04:59:31.358366208Z","updated_at":"2025-11-25T21:12:31.904860761Z","closed_at":"2025-11-25T21:12:31.904860761Z","labels":["infrastructure","priority-2","testing"]}
{"id":"clack-28n","title":"Add timezone support with TZ environment variable","description":"Add configurable timezone support using the POSIX standard TZ environment variable (default: America/Los_Angeles). Create a centralized timezone utility module that all components use for consistent time handling across LLM prompts, display frame, and greeting logic.","acceptance_criteria":"- TZ environment variable configures timezone (default: America/Los_Angeles)\n- New src/utils/timezone.ts provides centralized time formatting functions\n- All time displays use configured timezone: LLM prompts, info bar, color bar, greeting generator\n- Tests cover timezone utility with DST handling\n- 80%+ test coverage maintained","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-11-27T22:16:53.262300471Z","updated_at":"2025-11-28T01:15:36.094706003Z","closed_at":"2025-11-28T01:15:36.094706003Z"}
{"id":"clack-2b9","title":"Task 6.1: Update EventHandler with orchestrator integration","description":"Modify src/scheduler/event-handler.ts to use ContentOrchestrator for major updates and handle P0 notifications via state_changed events.","acceptance_criteria":"- Constructor accepts HomeAssistantClient and ContentOrchestrator\n- handleContentTrigger() calls orchestrator.generateAndSend()\n- handleStateChanged() for P0 notification matching\n- P0 events immediately interrupt current display\n- Unit tests with mocked orchestrator","status":"closed","priority":1,"issue_type":"task","assignee":"claude","created_at":"2025-11-26T22:16:50.298934175Z","updated_at":"2025-11-27T05:24:22.054324506Z","closed_at":"2025-11-27T05:24:22.054324506Z","dependencies":[{"issue_id":"clack-2b9","depends_on_id":"clack-zoy","type":"parent-child","created_at":"2025-11-26T22:16:57.812110679Z","created_by":"daemon"}]}
{"id":"clack-2jo","title":"Vestaboard API Wrapper - Testable Architecture","description":"Design and implement a highly testable, modular Vestaboard API wrapper following separation of concerns and dependency injection patterns. Split character conversion, HTTP communication, and orchestration into distinct, independently testable components with comprehensive test coverage (80%+).","design":"## Architecture Design\n\n### Component Separation\n1. **Character Converter** - Pure functions for text → character codes (no dependencies)\n2. **HTTP Client** - Fetch-based HTTP communication to Vestaboard Local API\n3. **Vestaboard Client** - Thin orchestration layer coordinating converter + HTTP\n4. **Factory Pattern** - Consistent with existing AI provider pattern\n\n### Dependency Injection\n- Constructor injection for all components\n- Interface-based design for mockability\n- No global state or singletons\n\n### Testability Strategy\n- Pure functions require zero mocks (character converter)\n- HTTP layer isolated and mockable\n- Mix real/mock implementations for different test levels\n- 80%+ coverage target across all components\n\n### File Structure\n```\nsrc/api/vestaboard/\n  character-converter.ts  # Pure functions + lookup table\n  http-client.ts          # VestaboardHTTPClient implementation\n  client.ts               # VestaboardClient orchestrator\n  errors.ts               # Error hierarchy\n  types.ts                # TypeScript interfaces\n  index.ts                # Factory + public exports\n```\n\n### References\n- Pattern: src/api/ai/index.ts (factory pattern)\n- Mocks: tests/__mocks__/ai-providers.ts\n- Tests: tests/unit/api/ai/openai.test.ts","acceptance_criteria":"- Character converter achieves 100% test coverage (pure functions)\n- HTTP client achieves 80%+ coverage with mocked fetch\n- Vestaboard client achieves 80%+ coverage with mocked dependencies\n- Integration tests pass with real converter + mock HTTP\n- Factory pattern matches AI provider conventions\n- All tests run in isolated environments (no real HTTP calls)\n- Existing usage sites (CronScheduler, EventHandler) work unchanged\n- Mock utilities available in tests/__mocks__/vestaboard.ts\n- Fixtures available in tests/fixtures/vestaboard-responses.json","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-26T05:23:59.213789466Z","updated_at":"2025-11-26T23:08:42.203255546Z","closed_at":"2025-11-26T23:08:42.203255546Z"}
{"id":"clack-2n6","title":"Create GlobalNewsGenerator (BBC, NYT)","description":"News generator for global/world news headlines.\n\n**Files:**\n- `src/content/generators/ai/global-news-generator.ts` (new)\n- `prompts/user/news-global.txt` (new)\n\n**Default Feeds:**\n- BBC News World: `https://feeds.bbci.co.uk/news/world/rss.xml`\n- NYT Headlines: `https://rss.nytimes.com/services/xml/rss/nyt/HomePage.xml`\n\n**Requirements:**\n- Extends base NewsGenerator\n- Uses `prompts/user/news-global.txt` for user prompt\n- Configurable via `RSS_GLOBAL_FEEDS` env var","status":"closed","priority":2,"issue_type":"task","assignee":"claude","created_at":"2025-11-27T09:20:59.010624216Z","updated_at":"2025-11-27T11:14:53.04703113Z","closed_at":"2025-11-27T11:14:53.04703113Z","labels":["content","news"],"dependencies":[{"issue_id":"clack-2n6","depends_on_id":"clack-viu","type":"parent-child","created_at":"2025-11-27T09:21:47.408452794Z","created_by":"daemon"},{"issue_id":"clack-2n6","depends_on_id":"clack-42e","type":"blocks","created_at":"2025-11-27T09:22:12.524192458Z","created_by":"daemon"}]}
{"id":"clack-2tg","title":"Task 4.2: Create ContentSelector for priority-based selection","description":"Create src/content/registry/content-selector.ts with select() method implementing P0 immediate interrupt, P2 random selection, P3 fallback logic.","acceptance_criteria":"- Constructor accepts ContentRegistry\n- select(context) returns RegisteredGenerator or null\n- P0: Match event pattern, immediate priority\n- P2: Random selection from normal priority\n- P3: Fallback selection\n- Unit tests for all priority scenarios","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-26T22:16:06.083678418Z","updated_at":"2025-11-27T04:11:31.913895762Z","closed_at":"2025-11-27T04:11:31.913895762Z","dependencies":[{"issue_id":"clack-2tg","depends_on_id":"clack-4lg","type":"parent-child","created_at":"2025-11-26T22:16:15.235615089Z","created_by":"daemon"},{"issue_id":"clack-2tg","depends_on_id":"clack-nux","type":"blocks","created_at":"2025-11-26T22:16:15.646631173Z","created_by":"daemon"}]}
{"id":"clack-2w5","title":"Implement Event Subscription System","description":"Implement subscribeToEvents(eventType, callback) with support for multiple subscribers per event type, auto-resubscribe on reconnection.","acceptance_criteria":"- subscribeToEvents(eventType, callback) method\n- Returns unsubscribe function\n- Multiple subscribers per event type\n- Event type filtering support\n- Internal event handler map\n- unsubscribeFromEvents(eventType) method\n- Auto-resubscribe on reconnection","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-24T00:18:44.33442047Z","updated_at":"2025-11-24T05:22:38.673297212Z","closed_at":"2025-11-24T05:22:38.673297212Z","dependencies":[{"issue_id":"clack-2w5","depends_on_id":"clack-ar9","type":"blocks","created_at":"2025-11-24T00:19:52.130242835Z","created_by":"daemon"},{"issue_id":"clack-2w5","depends_on_id":"clack-4qv","type":"blocks","created_at":"2025-11-24T00:19:53.28286096Z","created_by":"daemon"},{"issue_id":"clack-2w5","depends_on_id":"clack-0nr","type":"parent-child","created_at":"2025-11-24T04:19:01.927242417Z","created_by":"vscode"}]}
{"id":"clack-2wk","title":"Update WeatherGenerator to use context.data.weather","description":"Modify WeatherGenerator to receive weather data through GenerationContext instead of fetching directly.\n\n**Files:**\n- `src/content/generators/ai-prompt-generator.ts`\n- `src/content/generators/ai/weather-generator.ts`\n- `prompts/user/weather-focus.txt`\n\n**Requirements:**\n- Modify `formatUserPrompt()` in base class to include `context.data.weather`\n- Format weather as structured context section\n- Update weather-focus.txt to reference CURRENT WEATHER section\n- Benefits from single fetch shared with FrameDecorator","status":"closed","priority":2,"issue_type":"task","assignee":"claude","created_at":"2025-11-27T09:21:01.261381967Z","updated_at":"2025-11-27T12:08:50.186531836Z","closed_at":"2025-11-27T12:08:50.186531836Z","labels":["content","weather"],"dependencies":[{"issue_id":"clack-2wk","depends_on_id":"clack-viu","type":"parent-child","created_at":"2025-11-27T09:21:52.305895421Z","created_by":"daemon"},{"issue_id":"clack-2wk","depends_on_id":"clack-xu0","type":"blocks","created_at":"2025-11-27T09:22:15.88140521Z","created_by":"daemon"}]}
{"id":"clack-2yw","title":"Weather display blank in frame info bar despite configured WEATHER_ENTITY","description":"## Problem\nThe weather section on Row 5 (info bar) of the Vestaboard frame is blank. Weather should display as a color code followed by temperature (e.g., `⬜72F`), but currently shows nothing.\n\n## Expected Behavior\nInfo bar should display: `WED 26NOV 10:30 [color]72F` where `[color]` is a Vestaboard color code (63-69) based on temperature/conditions.\n\n## Actual Behavior\nInfo bar shows: `WED 26NOV 10:30      ` with blank weather section.\n\n## Configuration\n- `$WEATHER_ENTITY` environment variable should specify the Home Assistant entity (e.g., `weather.apple`)\n- WeatherService defaults to `weather.apple` if not set\n\n## Data Flow (where bug may exist)\n```\nHomeAssistant → WeatherService.getWeather() → ContentDataProvider.fetchData()\n    → orchestrator context.data → FrameDecorator.decorate() → formatInfoBar()\n```\n\n## Potential Root Causes\n1. **HA Client not injected** - WeatherService may not receive HomeAssistantClient\n2. **Entity lookup failing** - `haClient.getState(entityId)` returns null/error silently\n3. **Data not passed through pipeline** - ContentDataProvider result not reaching FrameDecorator\n4. **formatInfoBar() issue** - Weather data received but not rendered\n\n## Key Files to Investigate\n- `src/services/weather-service.ts` - WeatherService.getWeather(), entity lookup\n- `src/services/content-data-provider.ts` - fetchData() parallel weather fetch\n- `src/content/frame/frame-generator.ts:50-74` - Weather fetch logic\n- `src/content/frame/info-bar.ts` - formatInfoBar() weather rendering\n- `src/content/orchestrator.ts:122-181` - Pipeline data passing\n- `src/bootstrap.ts:230, 254-264` - Component wiring","acceptance_criteria":"- [ ] Weather displays correctly on Row 5 when WEATHER_ENTITY is configured\n- [ ] Temperature shows with correct unit (°F or °C based on HA entity)\n- [ ] Color code (63-69) renders based on temperature/condition\n- [ ] Graceful degradation: blank weather section only when HA unavailable\n- [ ] Unit tests cover the fixed code path\n- [ ] Integration test validates end-to-end weather display","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-11-27T20:40:55.488639958Z","updated_at":"2025-11-27T22:41:47.768911635Z","closed_at":"2025-11-27T22:41:47.768911635Z","labels":["frame","home-assistant","weather"]}
{"id":"clack-3lm","title":"CLI argument parser captures positional args as flag values","description":"## Problem\n\nThe CLI argument parser in `src/cli/index.ts` incorrectly captures positional arguments as values for preceding boolean flags.\n\n## Steps to Reproduce\n\n```bash\nnpm run frame -- --skip-weather --skip-colors TEST\n```\n\n**Expected:** `{ text: \"TEST\", skipWeather: true, skipColors: true }`\n**Actual:** `{ text: undefined, skipWeather: true, skipColors: \"TEST\" }`\n\nSince `skipColors` becomes `\"TEST\"` instead of `true`, the check `options['skip-colors'] === true` fails, and colors are NOT skipped.\n\n## Root Cause\n\nIn `src/cli/index.ts:19`:\n```typescript\nconst value = args[i + 1] \u0026\u0026 !args[i + 1].startsWith('--') ? args[i + 1] : true;\n```\n\nThis logic assumes any non-flag argument following a flag is that flag's value. It doesn't distinguish between:\n- Flags that expect values (e.g., `--provider openai`)\n- Boolean flags (e.g., `--skip-colors`)\n\n## Impact\n\n- Users must put text BEFORE flags: `npm run frame \"TEXT\" --skip-colors` (works)\n- Flags after text are silently misinterpreted, causing unexpected behavior\n- No error is shown, making debugging difficult\n\n## Suggested Fix\n\nOptions:\n1. Define which flags are boolean vs value-expecting\n2. Use a proper argument parsing library (e.g., `commander`, `yargs`)\n3. Require `=` syntax for value flags: `--provider=openai`","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-11-26T19:58:41.391390755Z","updated_at":"2025-11-26T22:37:43.568922255Z","closed_at":"2025-11-26T22:37:43.568922255Z","labels":["cli","usability"]}
{"id":"clack-3my","title":"Documentation","description":"Document the Home Assistant client API, configuration, and usage patterns.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-24T00:14:50.922107751Z","updated_at":"2025-11-25T00:28:39.963467754Z","closed_at":"2025-11-25T00:28:39.963467754Z"}
{"id":"clack-42e","title":"Create base NewsGenerator class with RSS self-fetching","description":"Abstract base class for all news generators that fetches RSS headlines before AI generation.\n\n**Files:** `src/content/generators/ai/base-news-generator.ts` (new)\n\n**Requirements:**\n- Extends `AIPromptGenerator`\n- Accepts `RSSClient` and `feedUrls: string[]` via constructor\n- Override `generate()` to fetch headlines before AI call\n- Format headlines and inject into user prompt context\n- Graceful fallback if RSS unavailable (AI generates without news)\n- Abstract `getUserPromptFile()` for subclasses to implement","status":"closed","priority":2,"issue_type":"task","assignee":"claude","created_at":"2025-11-27T09:20:42.363066167Z","updated_at":"2025-11-27T10:44:09.126142596Z","closed_at":"2025-11-27T10:44:09.126142596Z","labels":["content","news"],"dependencies":[{"issue_id":"clack-42e","depends_on_id":"clack-viu","type":"parent-child","created_at":"2025-11-27T09:21:47.134196044Z","created_by":"daemon"},{"issue_id":"clack-42e","depends_on_id":"clack-y91","type":"blocks","created_at":"2025-11-27T09:22:12.403816958Z","created_by":"daemon"}]}
{"id":"clack-4jw","title":"Welcome page with Vestaboard display and voting","description":"Build mobile-first home page displaying current Vestaboard content in a 6×22 character grid with thumbs up/down voting buttons connected to API.","design":"**Components:**\n1. VestaboardDisplay - 6×22 grid, split-flap aesthetic (amber/black)\n2. VotingButtons - Large touch-friendly thumbs up/down\n3. WelcomePage - Fetches content, handles voting\n\n**API Integration:**\n- Fetch latest content via apiClient.getLatestContent()\n- Submit votes via apiClient.submitVote()\n- Loading/error states\n\n**Styling:**\n- Split-flap aesthetic with shadows\n- Mobile-first responsive design\n- Success feedback after voting","acceptance_criteria":"- [ ] VestaboardDisplay renders 6×22 grid correctly\n- [ ] Split-flap aesthetic styling (amber/black with shadows)\n- [ ] Voting buttons large and touch-friendly (min 44×44px)\n- [ ] Vote submission shows loading state\n- [ ] Success feedback displayed after vote\n- [ ] Error handling with user-friendly messages\n- [ ] Mobile-first responsive design (320px min)\n- [ ] Empty state when no content available\n- [ ] Unit tests with 80%+ coverage\n- [ ] Integration test for voting flow","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-26T05:05:07.607553595Z","updated_at":"2025-11-26T05:05:07.607553595Z","labels":["frontend","ui","web"],"dependencies":[{"issue_id":"clack-4jw","depends_on_id":"clack-dor","type":"parent-child","created_at":"2025-11-26T05:05:20.453093337Z","created_by":"daemon"},{"issue_id":"clack-4jw","depends_on_id":"clack-ias","type":"blocks","created_at":"2025-11-26T05:05:30.446459675Z","created_by":"daemon"}]}
{"id":"clack-4lg","title":"Epic 4: Content Registry \u0026 Selection","description":"Implement registration and priority-based selection system. Singleton registry for all generators with priority selection (P0 immediate interrupt, P2 general, P3 fallback).","status":"closed","priority":1,"issue_type":"epic","assignee":"claude","created_at":"2025-11-26T22:14:23.961499135Z","updated_at":"2025-11-27T04:11:32.339492303Z","closed_at":"2025-11-27T04:11:32.339492303Z","labels":["content-system","registry","selection"],"dependencies":[{"issue_id":"clack-4lg","depends_on_id":"clack-6vv","type":"blocks","created_at":"2025-11-26T22:14:35.235232168Z","created_by":"daemon"}]}
{"id":"clack-4qv","title":"Update Type Definitions","description":"Extend HomeAssistantConfig and add event types, state types, and error types in src/types/data-sources.ts.","acceptance_criteria":"- Extended HomeAssistantConfig type\n- HomeAssistantEvent type with event_type\n- StateChangedEvent type\n- HomeAssistantEntityState type with context\n- UnsubscribeFunc type\n- ServiceCallResponse type\n- Error types (extends base Error)\n- All types exported from src/types/index.ts","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-24T00:18:53.296351752Z","updated_at":"2025-11-24T04:32:05.830599419Z","closed_at":"2025-11-24T04:32:05.830599419Z","dependencies":[{"issue_id":"clack-4qv","depends_on_id":"clack-n94","type":"parent-child","created_at":"2025-11-24T04:19:55.831357845Z","created_by":"vscode"}]}
{"id":"clack-57t","title":"Write Unit Tests","description":"Create comprehensive unit tests in tests/unit/api/data-sources/home-assistant.test.ts with 80%+ coverage.","acceptance_criteria":"- Test file created\n- Test connection establishment (success)\n- Test connection failure scenarios\n- Test disconnect cleanup\n- Test event subscription/unsubscription\n- Test event callback invocation\n- Test multiple subscribers\n- Test getState() success/failure\n- Test getAllStates()\n- Test callService() success/failure\n- Test reconnection logic\n- Test max reconnection attempts\n- Test auto-resubscribe\n- Test graceful degradation\n- 80%+ coverage verified","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-24T00:18:57.490100296Z","updated_at":"2025-11-24T08:56:03.896381764Z","closed_at":"2025-11-24T08:56:03.896381764Z","dependencies":[{"issue_id":"clack-57t","depends_on_id":"clack-wxg","type":"blocks","created_at":"2025-11-24T00:20:03.807708674Z","created_by":"daemon"},{"issue_id":"clack-57t","depends_on_id":"clack-ar9","type":"blocks","created_at":"2025-11-24T00:20:05.051381299Z","created_by":"daemon"},{"issue_id":"clack-57t","depends_on_id":"clack-iwr","type":"blocks","created_at":"2025-11-24T00:20:06.299932341Z","created_by":"daemon"},{"issue_id":"clack-57t","depends_on_id":"clack-2w5","type":"blocks","created_at":"2025-11-24T00:20:07.4258858Z","created_by":"daemon"},{"issue_id":"clack-57t","depends_on_id":"clack-y4k","type":"blocks","created_at":"2025-11-24T00:20:08.558567134Z","created_by":"daemon"},{"issue_id":"clack-57t","depends_on_id":"clack-1wi","type":"blocks","created_at":"2025-11-24T00:20:09.939995635Z","created_by":"daemon"},{"issue_id":"clack-57t","depends_on_id":"clack-p30","type":"blocks","created_at":"2025-11-24T00:20:11.177343969Z","created_by":"daemon"},{"issue_id":"clack-57t","depends_on_id":"clack-926","type":"parent-child","created_at":"2025-11-24T04:20:28.049451763Z","created_by":"vscode"}]}
{"id":"clack-5ey","title":"Throttled Error Logging","description":"Implement throttled logging to prevent error spam (same error logged 60 times/hour).\n\n**Files to create**:\n- `src/utils/throttled-logger.ts` - ThrottledLogger class\n\n**Files to modify**:\n- `src/scheduler/cron.ts` - Use throttled logger for errors\n\n**Implementation**:\n- Log same error type at most once per 5 minutes\n- Track suppressed count per error key\n- Show suppressed count when logging resumes","acceptance_criteria":"- Same error type logged at most once per 5 minutes\n- Suppressed count shown when logging resumes\n- Different error types logged independently\n- Tests verify throttling behavior","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-27T21:49:12.494968633Z","updated_at":"2025-11-27T21:49:12.494968633Z","labels":["utility"],"dependencies":[{"issue_id":"clack-5ey","depends_on_id":"clack-hfu","type":"parent-child","created_at":"2025-11-27T21:49:45.809881259Z","created_by":"daemon"}]}
{"id":"clack-5gp","title":"Write Integration Tests (Real Converter + Mock HTTP)","description":"Create integration tests combining real character converter with mocked HTTP client. Verify end-to-end text → character codes → HTTP flow.","design":"## Integration Test Strategy\n- Real character converter (production implementation)\n- Mock HTTP client (no network calls)\n- Verify exact character codes sent\n- Compare against fixtures\n\nCoverage:\n1. Simple text conversion and send\n2. Multi-line layout conversion\n3. Invalid characters handling\n4. Character code accuracy verification","acceptance_criteria":"- tests/integration/api/vestaboard/client-integration.test.ts created\n- Test sendText() with real converter, mock HTTP\n- Test sendLayout() with multi-line text, real converter\n- Verify exact character codes sent match expected values\n- Compare against vestaboard-responses.json fixtures\n- Test \"HELLO WORLD\" produces correct codes [8,5,12,12,15,0,23,15,18,12,4]\n- Test motivational quote with centering\n- Test invalid character throws error (via real converter)\n- Test full 6-row layout\n- All integration tests pass\n- Uses createMockVestaboardHTTPClient() for HTTP\n- Uses real character converter implementation","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-26T05:25:59.536056549Z","updated_at":"2025-11-26T05:25:59.536056549Z","dependencies":[{"issue_id":"clack-5gp","depends_on_id":"clack-q4k","type":"blocks","created_at":"2025-11-26T05:25:59.541509882Z","created_by":"daemon"},{"issue_id":"clack-5gp","depends_on_id":"clack-9u3","type":"blocks","created_at":"2025-11-26T05:25:59.543419674Z","created_by":"daemon"},{"issue_id":"clack-5gp","depends_on_id":"clack-y4i","type":"blocks","created_at":"2025-11-26T05:25:59.544384966Z","created_by":"daemon"}]}
{"id":"clack-5i1","title":"Document Token Creation","description":"Add step-by-step token creation instructions, security best practices, and .env setup examples.","acceptance_criteria":"- Step-by-step token creation instructions\n- HA UI navigation documented\n- Security best practices\n- Token permissions documented\n- .env setup examples\n- CLI tool connectivity testing documented","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T00:19:02.953628507Z","updated_at":"2025-11-25T00:28:39.713654046Z","closed_at":"2025-11-25T00:28:39.713654046Z","dependencies":[{"issue_id":"clack-5i1","depends_on_id":"clack-1ls","type":"blocks","created_at":"2025-11-24T00:20:24.960259461Z","created_by":"daemon"},{"issue_id":"clack-5i1","depends_on_id":"clack-3my","type":"parent-child","created_at":"2025-11-24T04:21:10.91151938Z","created_by":"vscode"}]}
{"id":"clack-69j","title":"Create TechNewsGenerator (HN, TechCrunch, Ars)","description":"News generator for tech/startup news headlines.\n\n**Files:**\n- `src/content/generators/ai/tech-news-generator.ts` (new)\n- `prompts/user/news-tech.txt` (new)\n\n**Default Feeds:**\n- Hacker News: `https://hnrss.org/frontpage`\n- TechCrunch: `https://techcrunch.com/feed/`\n- Ars Technica: `https://feeds.arstechnica.com/arstechnica/index`\n\n**Requirements:**\n- Extends base NewsGenerator\n- Uses `prompts/user/news-tech.txt` for user prompt\n- Configurable via `RSS_TECH_FEEDS` env var","status":"closed","priority":2,"issue_type":"task","assignee":"claude","created_at":"2025-11-27T09:20:59.156966175Z","updated_at":"2025-11-27T11:14:53.24384088Z","closed_at":"2025-11-27T11:14:53.24384088Z","labels":["content","news"],"dependencies":[{"issue_id":"clack-69j","depends_on_id":"clack-viu","type":"parent-child","created_at":"2025-11-27T09:21:48.645144878Z","created_by":"daemon"},{"issue_id":"clack-69j","depends_on_id":"clack-42e","type":"blocks","created_at":"2025-11-27T09:22:12.655530333Z","created_by":"daemon"}]}
{"id":"clack-6bd","title":"Implement placeholder model methods (VoteModel, ContentModel, LogModel)","description":"Model implementations (VoteModel, ContentModel, LogModel) are currently stubs that throw \"Not implemented\" errors. These need to be implemented for full integration testing of API routes.\n\nCurrent Status: Models exist but all methods throw errors with TODO comments\n\nAffected Models:\n- VoteModel: create(), getStats(), findByContentId() methods\n- ContentModel: getLatest(), getHistory() methods  \n- LogModel: findRecent(), deleteOlderThan() methods\n\nImpact: Cannot run full integration tests for API routes until these are implemented","design":"Models should implement database operations using existing Database/Repository patterns in the codebase. Follow TDD methodology:\n1. Write tests for model methods\n2. Implement database queries\n3. Integrate with existing repositories","acceptance_criteria":"- All model methods implemented with database operations\n- Unit tests for model methods with 80%+ coverage\n- Integration tests with repositories passing\n- No \"Not implemented\" errors remaining","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T15:46:13.591253708Z","updated_at":"2025-11-24T17:03:06.787075425Z","closed_at":"2025-11-24T17:03:06.787075425Z","labels":["database","models","task"]}
{"id":"clack-6oq","title":"Task 3.3: Create base ProgrammaticGenerator abstract class","description":"Create src/content/generators/programmatic-generator.ts with abstract base for non-AI content generation.","acceptance_criteria":"- Abstract class implementing ContentGenerator\n- Default validate() returns { valid: true }\n- Abstract generate() method\n- Unit tests","status":"closed","priority":1,"issue_type":"task","assignee":"claude","created_at":"2025-11-26T22:15:39.295873503Z","updated_at":"2025-11-27T01:38:55.666195343Z","closed_at":"2025-11-27T01:38:55.666195343Z","dependencies":[{"issue_id":"clack-6oq","depends_on_id":"clack-6vv","type":"parent-child","created_at":"2025-11-26T22:15:50.392094217Z","created_by":"daemon"}]}
{"id":"clack-6pj","title":"Update Votes and Logs Tables for MySQL","description":"Migrate votes and logs tables to MySQL with proper foreign keys.\n\n**Files to modify**:\n- `src/storage/models/vote.ts` - Update for MySQL\n- `src/storage/models/log.ts` - Update for MySQL\n- `src/storage/migrations/001_initial_schema.sql` - Add tables\n\n**Schema additions**:\n- votes table with FK to content(id) ON DELETE CASCADE\n- logs table with level ENUM and metadata JSON\n- Proper indexes for each table","acceptance_criteria":"- Foreign key constraint works (cascade delete)\n- Vote and log operations work\n- Indexes created","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-27T21:49:08.752934089Z","updated_at":"2025-11-27T21:49:08.752934089Z","labels":["database","schema"],"dependencies":[{"issue_id":"clack-6pj","depends_on_id":"clack-hsa","type":"blocks","created_at":"2025-11-27T21:49:31.759669961Z","created_by":"daemon"},{"issue_id":"clack-6pj","depends_on_id":"clack-hfu","type":"parent-child","created_at":"2025-11-27T21:49:45.366972926Z","created_by":"daemon"}]}
{"id":"clack-6pp","title":"Refactor content-list.test.ts - remove brittle fixed-count assertion","description":"The test asserts a fixed count (/total.*2/i) which breaks whenever generators are added/removed.\n\n**Failures:** 1 test\n- should show total count at the end\n\n**Fix:** Refactor assertion to test format, not exact count:\n- Change from: expect(output).toMatch(/total.*2/i)\n- Change to: expect(output).toMatch(/Total: \\d+ generator/)\n\n**Files:** tests/unit/cli/commands/content-list.test.ts","status":"open","priority":2,"issue_type":"bug","created_at":"2025-11-28T02:24:32.299082001Z","updated_at":"2025-11-28T02:24:32.299082001Z"}
{"id":"clack-6vv","title":"Epic 3: Content Generator Implementations","description":"Create concrete generator classes for AI-powered content, programmatic content, static fallback, and notifications. Includes base classes and specific implementations.","status":"closed","priority":1,"issue_type":"epic","assignee":"claude","created_at":"2025-11-26T22:14:23.679796885Z","updated_at":"2025-11-27T03:39:54.171115425Z","closed_at":"2025-11-27T03:39:54.171115425Z","labels":["content-system","generators"],"dependencies":[{"issue_id":"clack-6vv","depends_on_id":"clack-b5o","type":"blocks","created_at":"2025-11-26T22:14:34.944487668Z","created_by":"daemon"},{"issue_id":"clack-6vv","depends_on_id":"clack-adr","type":"blocks","created_at":"2025-11-26T22:14:35.051321918Z","created_by":"daemon"}]}
{"id":"clack-745","title":"Implement Vestaboard Client Orchestrator","description":"Create main VestaboardClient class that orchestrates character conversion and HTTP communication via dependency injection. Thin delegation layer with no business logic.","design":"## Dependency Injection Pattern\nConstructor receives:\n- VestaboardHTTPClient (for HTTP communication)\n- CharacterConverter (for text conversion)\n\n## Responsibilities\n- Coordinate conversion + HTTP (thin orchestration)\n- NO direct HTTP calls (delegate to httpClient)\n- NO character conversion logic (delegate to converter)\n- Error propagation from dependencies\n\n## Methods\n- sendLayout(layout: VestaboardLayout): Promise\u0026lt;void\u0026gt;\n- sendText(text: string): Promise\u0026lt;void\u0026gt;\n- validateConnection(): Promise\u0026lt;boolean\u0026gt;","acceptance_criteria":"- src/api/vestaboard/client.ts created\n- VestaboardClient class implements VestaboardSender interface\n- Constructor accepts (httpClient: VestaboardHTTPClient, converter: CharacterConverter)\n- sendLayout() converts layout to codes, delegates to httpClient\n- sendText() creates simple layout, converts, sends\n- validateConnection() delegates to httpClient\n- No business logic in orchestrator (pure delegation)\n- Error propagation from dependencies preserved\n- Exported from src/api/vestaboard/index.ts","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-26T05:24:39.501424596Z","updated_at":"2025-11-26T05:24:39.501424596Z","dependencies":[{"issue_id":"clack-745","depends_on_id":"clack-u7h","type":"blocks","created_at":"2025-11-26T05:24:39.502905971Z","created_by":"daemon"},{"issue_id":"clack-745","depends_on_id":"clack-ko4","type":"blocks","created_at":"2025-11-26T05:24:39.503698971Z","created_by":"daemon"}]}
{"id":"clack-7fx","title":"Task 3.5: Create StaticFallbackGenerator for P3 content","description":"Create src/content/generators/static-fallback-generator.ts that randomly selects content from prompts/static/*.txt files.","acceptance_criteria":"- Reads .txt files from fallback directory\n- Random selection on each generate() call\n- validate() checks directory exists and has files\n- Graceful error handling\n- Unit tests with mocked filesystem","status":"closed","priority":1,"issue_type":"task","assignee":"claude","created_at":"2025-11-26T22:15:40.12343617Z","updated_at":"2025-11-27T01:45:52.156053258Z","closed_at":"2025-11-27T01:45:52.156053258Z","dependencies":[{"issue_id":"clack-7fx","depends_on_id":"clack-6vv","type":"parent-child","created_at":"2025-11-26T22:15:50.655355384Z","created_by":"daemon"}]}
{"id":"clack-7l3","title":"Task 6.3: Update CronScheduler wiring","description":"Modify src/scheduler/cron.ts to wire up updated MinorUpdateGenerator with orchestrator dependency.","acceptance_criteria":"- CronScheduler uses updated MinorUpdateGenerator\n- Minute-aligned scheduling maintained\n- Integration test for full minor update flow","status":"closed","priority":2,"issue_type":"task","assignee":"claude","created_at":"2025-11-26T22:16:50.638834842Z","updated_at":"2025-11-27T05:38:52.09044584Z","closed_at":"2025-11-27T05:38:52.09044584Z","dependencies":[{"issue_id":"clack-7l3","depends_on_id":"clack-zoy","type":"parent-child","created_at":"2025-11-26T22:16:58.021510429Z","created_by":"daemon"},{"issue_id":"clack-7l3","depends_on_id":"clack-b1m","type":"blocks","created_at":"2025-11-26T22:16:58.278353596Z","created_by":"daemon"}]}
{"id":"clack-7tb","title":"Define TypeScript Interfaces and Error Types","description":"Create type definitions for Vestaboard API wrapper interfaces and custom error hierarchy in src/api/vestaboard/types.ts and errors.ts. Foundation for type-safe implementation.","acceptance_criteria":"- types.ts created with VestaboardConfig, VestaboardResponse, VestaboardMessage interfaces\n- CharacterConverter interface defined\n- VestaboardHTTPClient interface defined\n- VestaboardSender interface defined\n- errors.ts created with VestaboardError base class\n- VestaboardConnectionError, VestaboardAuthenticationError, VestaboardInvalidMessageError defined\n- VestaboardUnsupportedCharacterError defined\n- All error types extend base VestaboardError\n- Types exported from src/api/vestaboard/index.ts","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-26T05:24:07.547998428Z","updated_at":"2025-11-26T23:07:06.93190746Z","closed_at":"2025-11-26T23:07:06.93190746Z","dependencies":[{"issue_id":"clack-7tb","depends_on_id":"clack-2jo","type":"blocks","created_at":"2025-11-26T05:24:07.54868972Z","created_by":"daemon"}]}
{"id":"clack-8kd","title":"Task 5.3: Implement retry logic with alternate provider fallback","description":"Add generateWithRetry() private method to ContentOrchestrator handling AI failure with cross-provider retry before falling to P3.","acceptance_criteria":"- generateWithRetry(generator, context) method\n- Try preferred provider first\n- On RateLimitError or AuthenticationError, try alternate\n- Throw after both fail (triggers P3 fallback in main method)\n- Unit tests for all failure scenarios","status":"closed","priority":1,"issue_type":"task","assignee":"claude","created_at":"2025-11-26T22:16:30.04526093Z","updated_at":"2025-11-27T05:11:16.603143087Z","closed_at":"2025-11-27T05:11:16.603143087Z","dependencies":[{"issue_id":"clack-8kd","depends_on_id":"clack-zoc","type":"parent-child","created_at":"2025-11-26T22:16:38.009328586Z","created_by":"daemon"},{"issue_id":"clack-8kd","depends_on_id":"clack-8wd","type":"blocks","created_at":"2025-11-26T22:16:38.251086253Z","created_by":"daemon"}]}
{"id":"clack-8v1","title":"Fix orchestrator.test.ts - FrameDecorator.decorate() expects 3 args","description":"The FrameDecorator.decorate() method signature was changed to accept a third parameter (context.data), but test assertions weren't updated.\n\n**Failures:** 2 tests\n- should select generator, generate content, decorate, cache, and send\n- should fall back to StaticFallbackGenerator when retry fails\n\n**Fix:** Update test assertions at lines 141 and 314 to expect the third argument.\n\n**Files:** tests/unit/content/orchestrator.test.ts","status":"open","priority":1,"issue_type":"bug","created_at":"2025-11-28T02:24:18.754712301Z","updated_at":"2025-11-28T02:24:18.754712301Z"}
{"id":"clack-8wd","title":"Task 5.1: Create ContentOrchestrator main pipeline","description":"Create src/content/orchestrator.ts coordinating selection, generation, retry, P3 fallover, frame decoration, and content caching for minor updates.","acceptance_criteria":"- Constructor accepts ContentSelector, FrameDecorator, VestaboardClient, StaticFallbackGenerator\n- generateAndSend(context) method with full pipeline\n- Retry logic: try alternate provider once before P3 fallback\n- Apply frame if outputMode === 'text'\n- Cache last successful content (cachedContent property)\n- getCachedContent() method for minor updates\n- Unit tests with mocked dependencies","status":"closed","priority":1,"issue_type":"task","assignee":"claude","created_at":"2025-11-26T22:16:29.778729346Z","updated_at":"2025-11-27T05:11:16.282459962Z","closed_at":"2025-11-27T05:11:16.282459962Z","dependencies":[{"issue_id":"clack-8wd","depends_on_id":"clack-zoc","type":"parent-child","created_at":"2025-11-26T22:16:37.745629586Z","created_by":"daemon"},{"issue_id":"clack-8wd","depends_on_id":"clack-r0g","type":"blocks","created_at":"2025-11-26T22:16:38.133131086Z","created_by":"daemon"}]}
{"id":"clack-926","title":"Testing Infrastructure","description":"Create comprehensive test suite with mocks, fixtures, and testing tools for the Home Assistant client.","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-11-24T00:14:50.680916834Z","updated_at":"2025-11-24T08:56:03.735446889Z","closed_at":"2025-11-24T08:56:03.735446889Z"}
{"id":"clack-941","title":"90-Day Retention Cleanup","description":"Add scheduled cleanup job to delete content older than 90 days.\n\n**Files to modify**:\n- `src/storage/models/content.ts` - Add `deleteOlderThan()` method\n- `src/scheduler/cron.ts` or new file - Add daily cleanup job\n\n**Implementation**:\n```typescript\n// ContentModel\nasync deleteOlderThan(days: number): Promise\u003cnumber\u003e {\n  const result = await this.db.run(\n    'DELETE FROM content WHERE generated_at \u003c DATE_SUB(NOW(), INTERVAL ? DAY)',\n    [days]\n  );\n  return result.changes;\n}\n```\n\nRun cleanup daily or on startup.","acceptance_criteria":"- Records older than 90 days deleted\n- Cleanup runs daily (or on startup)\n- Deletion count logged\n- Doesn't affect votes FK (cascade handles this)","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-27T21:49:13.4711153Z","updated_at":"2025-11-27T21:49:13.4711153Z","labels":["maintenance"],"dependencies":[{"issue_id":"clack-941","depends_on_id":"clack-hfu","type":"parent-child","created_at":"2025-11-27T21:49:45.931624801Z","created_by":"daemon"}]}
{"id":"clack-96v","title":"Update content:test CLI with validation and prompt display","description":"Enhance npm run content:test CLI output to show the user prompt sent to LLM and the validation result (pass/fail with detailed metrics).","design":"File: src/cli/commands/content-test.ts\n\nAdd new output sections:\n1. USER PROMPT SENT TO LLM - show content.metadata.userPrompt\n2. VALIDATION RESULT - call validateGeneratorOutput() and display:\n   - Status: ✅ PASSED or ❌ FAILED\n   - Lines: X/5\n   - Max line length: X/21\n   - Invalid characters: none or list","acceptance_criteria":"- Shows user prompt when available (AI generators)\n- Shows validation pass/fail status\n- Shows detailed metrics (line count, max length, invalid chars)\n- Gracefully handles validation failures in display","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-11-27T20:03:12.5614148Z","updated_at":"2025-11-27T20:38:18.086073052Z","closed_at":"2025-11-27T20:38:18.086073052Z","dependencies":[{"issue_id":"clack-96v","depends_on_id":"clack-foo","type":"parent-child","created_at":"2025-11-27T20:03:23.39776618Z","created_by":"daemon"},{"issue_id":"clack-96v","depends_on_id":"clack-rnx","type":"blocks","created_at":"2025-11-27T20:03:30.262537044Z","created_by":"daemon"},{"issue_id":"clack-96v","depends_on_id":"clack-pds","type":"blocks","created_at":"2025-11-27T20:03:30.391189294Z","created_by":"daemon"}]}
{"id":"clack-9mi","title":"Install and configure Tailwind CSS and shadcn/ui","description":"Set up Tailwind CSS build pipeline and initialize shadcn/ui component system with mobile-first responsive design configuration.","design":"**Package Installation:**\n- tailwindcss, postcss, autoprefixer (dev dependencies)\n- class-variance-authority, clsx, tailwind-merge (shadcn deps)\n- react-router-dom (routing)\n\n**Configuration Files:**\n- tailwind.config.ts - Mobile-first breakpoints, dark mode class strategy\n- postcss.config.cjs - Tailwind processor\n- src/web/frontend/index.css - @tailwind directives\n\n**shadcn/ui Setup:**\n- Run: npx shadcn@latest init\n- Install base components: button, card, input, badge, separator, sheet, toast\n- Components dir: src/web/frontend/components/ui\n\n**Directory Structure:**\n- components/ui/ (shadcn generated)\n- components/layout/ (navigation, page layouts)\n- components/features/ (vestaboard-preview, voting, etc.)\n- lib/utils.ts (cn() helper)","acceptance_criteria":"- [ ] Tailwind CSS installed and configured with mobile-first breakpoints\n- [ ] PostCSS configuration working with Vite build\n- [ ] shadcn/ui initialized with button, card, input, badge, separator, sheet, toast\n- [ ] Component directory structure created (ui/, layout/, features/)\n- [ ] index.css with Tailwind directives imported in main.tsx\n- [ ] Dev server starts with HMR for Tailwind changes\n- [ ] Production build completes without errors\n- [ ] All existing tests pass\n- [ ] Linting passes","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-26T05:05:06.736838136Z","updated_at":"2025-11-26T05:05:06.736838136Z","labels":["tooling","ui","web"],"dependencies":[{"issue_id":"clack-9mi","depends_on_id":"clack-dor","type":"parent-child","created_at":"2025-11-26T05:05:20.145453545Z","created_by":"daemon"}]}
{"id":"clack-9u3","title":"Write Unit Tests for HTTP Client","description":"Create unit tests for VestaboardHTTPClient with mocked fetch API. Target: 80%+ coverage covering success cases, error handling, and connection validation.","design":"## Test Strategy\nMock global.fetch using jest.fn()\n\nCoverage areas:\n1. Successful message send\n2. Error handling (401, 403, 400, timeout)\n3. Header injection (X-Vestaboard-Local-Api-Key)\n4. Request body format\n5. Response parsing\n6. Connection validation\n7. Custom error types\n\nReference: tests/unit/api/ai/openai.test.ts (SDK mocking pattern)","acceptance_criteria":"- tests/unit/api/vestaboard/http-client.test.ts created\n- Test sendMessage() success with mocked fetch\n- Test sendMessage() with 401 auth error → VestaboardAuthenticationError\n- Test sendMessage() with 403 auth error → VestaboardAuthenticationError\n- Test sendMessage() with 400 error → VestaboardInvalidMessageError\n- Test sendMessage() with network error → VestaboardConnectionError\n- Test sendMessage() with timeout → VestaboardConnectionError\n- Test getCurrentMessage() success\n- Test validateConnection() returns true on success\n- Test validateConnection() returns false on failure\n- Test X-Vestaboard-Local-Api-Key header injection\n- Test request body format (character codes array)\n- Test response parsing\n- 80%+ coverage achieved\n- All tests pass\n- Uses mocked fetch (no real HTTP)","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-26T05:25:29.379422841Z","updated_at":"2025-11-26T05:25:29.379422841Z","dependencies":[{"issue_id":"clack-9u3","depends_on_id":"clack-ko4","type":"blocks","created_at":"2025-11-26T05:25:29.380145091Z","created_by":"daemon"},{"issue_id":"clack-9u3","depends_on_id":"clack-suz","type":"blocks","created_at":"2025-11-26T05:25:29.381288507Z","created_by":"daemon"},{"issue_id":"clack-9u3","depends_on_id":"clack-jc1","type":"blocks","created_at":"2025-11-26T05:25:29.381920091Z","created_by":"daemon"}]}
{"id":"clack-9zv","title":"WeatherGenerator doesn't inject weather data into prompts","description":"When running `npm run content:test weather-focus`, the generated content never references actual local weather data. The prompt expects weather data but never receives it.\n\n**Root Cause**: `WeatherGenerator` extends `AIPromptGenerator` but doesn't override `generate()` to fetch and inject weather data. The prompt file `weather-focus.txt` references \"CURRENT WEATHER section above\" that doesn't exist.\n\n**Evidence**:\n- `WeatherGenerator` only implements `getSystemPromptFile()` and `getUserPromptFile()`\n- No `WeatherService` dependency injection\n- No template variables for weather data in prompt loading\n- `BaseNewsGenerator` shows the correct pattern (fetches RSS, injects as `{{headlines}}`)","design":"Follow the `BaseNewsGenerator` pattern:\n\n1. Accept `WeatherService` in constructor (dependency injection)\n2. Override `generate()` method\n3. Fetch weather data via `WeatherService.getWeather()`\n4. Format weather as template variable\n5. Pass to `loadPromptWithVariables()` with `{ weather: formattedWeather }`\n6. Update prompt to use `{{weather}}` placeholder","acceptance_criteria":"- [ ] `npm run content:test weather-focus` shows actual weather data in generated content\n- [ ] WeatherGenerator fetches weather via WeatherService\n- [ ] Weather data injected via template variable `{{weather}}`\n- [ ] Graceful fallback when weather unavailable\n- [ ] Unit tests cover weather injection and fallback\n- [ ] Existing tests continue to pass","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-11-27T19:41:55.004805625Z","updated_at":"2025-11-27T20:01:42.116344508Z","closed_at":"2025-11-27T20:01:42.116344508Z"}
{"id":"clack-a13","title":"Add security headers middleware (helmet.js)","description":"Configure helmet middleware in Express server to set security headers: X-Frame-Options, Content-Security-Policy, X-Content-Type-Options, etc.","design":"Install helmet package and add middleware to src/web/server.ts:\n- npm install helmet @types/helmet\n- import helmet from 'helmet'\n- app.use(helmet())\n- Configure CSP for static assets and API endpoints","acceptance_criteria":"- helmet middleware added to Express server\n- Security headers present in HTTP responses\n- Tests verify headers are set correctly\n- No breaking changes to existing functionality","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T18:47:55.610565297Z","updated_at":"2025-11-26T01:48:21.11763542Z","closed_at":"2025-11-26T01:48:21.11763542Z","labels":["priority-2","security","web"],"dependencies":[{"issue_id":"clack-a13","depends_on_id":"clack-ddj","type":"parent-child","created_at":"2025-11-23T23:47:45.270440846Z","created_by":"daemon"}]}
{"id":"clack-adr","title":"Epic 2: Model Tier \u0026 AI Provider Enhancement","description":"Extend AI provider system to support tiered model selection (light/medium/heavy) with cross-provider fallback. Includes model tier configuration, selector class, and factory enhancement.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-26T22:14:23.398764635Z","updated_at":"2025-11-27T01:13:17.980470964Z","closed_at":"2025-11-27T01:13:17.980470964Z","labels":["ai","content-system","model-tiers"],"dependencies":[{"issue_id":"clack-adr","depends_on_id":"clack-b5o","type":"blocks","created_at":"2025-11-26T22:14:34.833081959Z","created_by":"daemon"}]}
{"id":"clack-aqq","title":"Create LocalNewsGenerator (LA Times, KTLA)","description":"News generator for local LA area news headlines.\n\n**Files:**\n- `src/content/generators/ai/local-news-generator.ts` (new)\n- `prompts/user/news-local.txt` (new)\n\n**Default Feeds:**\n- LA Times: `https://www.latimes.com/local/rss2.0.xml`\n- KTLA: `https://ktla.com/feed/`\n\n**Requirements:**\n- Extends base NewsGenerator\n- Uses `prompts/user/news-local.txt` for user prompt\n- Configurable via `RSS_LOCAL_FEEDS` env var","status":"closed","priority":2,"issue_type":"task","assignee":"claude","created_at":"2025-11-27T09:21:00.515239384Z","updated_at":"2025-11-27T11:14:53.42526238Z","closed_at":"2025-11-27T11:14:53.42526238Z","labels":["content","news"],"dependencies":[{"issue_id":"clack-aqq","depends_on_id":"clack-viu","type":"parent-child","created_at":"2025-11-27T09:21:49.776614128Z","created_by":"daemon"},{"issue_id":"clack-aqq","depends_on_id":"clack-42e","type":"blocks","created_at":"2025-11-27T09:22:12.807178084Z","created_by":"daemon"}]}
{"id":"clack-ar9","title":"Implement Connection Management","description":"Create WebSocket polyfill for Node.js, implement connect/disconnect methods with long-lived token auth, add connection state tracking and validation.","acceptance_criteria":"- connect() method with long-lived token auth\n- disconnect() method with cleanup\n- isConnected() status check\n- validateConnection() for testing\n- Connection state tracking","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-24T00:18:26.514526878Z","updated_at":"2025-11-24T05:16:43.254774964Z","closed_at":"2025-11-24T05:16:43.254774964Z","dependencies":[{"issue_id":"clack-ar9","depends_on_id":"clack-1h3","type":"blocks","created_at":"2025-11-24T00:19:43.129430136Z","created_by":"daemon"},{"issue_id":"clack-ar9","depends_on_id":"clack-d1q","type":"blocks","created_at":"2025-11-24T00:19:49.270928667Z","created_by":"daemon"},{"issue_id":"clack-ar9","depends_on_id":"clack-0nr","type":"parent-child","created_at":"2025-11-24T04:18:51.689510551Z","created_by":"vscode"}]}
{"id":"clack-avo","title":"Update AI model tiers to latest 2025 models (GPT-4.1 + Claude 4.5)","description":"Update the MODEL_TIERS configuration to use the latest 2025 models from both providers:\n\nOpenAI (GPT-4.1 family):\n- light: gpt-4.1-nano\n- medium: gpt-4.1-mini  \n- heavy: gpt-4.1\n\nAnthropic (Claude 4.5 family):\n- light: claude-haiku-4-5-20251001\n- medium: claude-sonnet-4-5-20250929\n- heavy: claude-opus-4-5-20251101\n\nCurrent models (gpt-4o-mini, gpt-4o, gpt-4-turbo and claude-3-haiku, claude-3-5-sonnet, claude-3-opus) are outdated.","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-11-27T07:32:22.990906548Z","updated_at":"2025-11-27T07:37:18.295779837Z","closed_at":"2025-11-27T07:37:18.295779837Z"}
{"id":"clack-b1m","title":"Task 6.2: Update MinorUpdateGenerator for cached content","description":"Modify src/content/generators/minor-update.ts to use orchestrator's cached content and reapply frame with updated time/weather.","acceptance_criteria":"- Constructor accepts ContentOrchestrator and FrameDecorator\n- generate() retrieves cached content from orchestrator\n- Reapplies frame with current timestamp if outputMode === 'text'\n- Returns cached content directly if outputMode === 'layout'\n- Unit tests","status":"closed","priority":1,"issue_type":"task","assignee":"claude","created_at":"2025-11-26T22:16:50.455256092Z","updated_at":"2025-11-27T05:24:22.181395548Z","closed_at":"2025-11-27T05:24:22.181395548Z","dependencies":[{"issue_id":"clack-b1m","depends_on_id":"clack-zoy","type":"parent-child","created_at":"2025-11-26T22:16:57.91667997Z","created_by":"daemon"},{"issue_id":"clack-b1m","depends_on_id":"clack-2b9","type":"blocks","created_at":"2025-11-26T22:16:58.162699721Z","created_by":"daemon"}]}
{"id":"clack-b4r","title":"Update WebSocket documentation to use wss:// for security","description":"Security audit identified that documentation examples use ws:// (unencrypted WebSocket) instead of wss:// (encrypted WebSocket over TLS). Production deployments should use wss:// to prevent man-in-the-middle attacks.\n\n**Files to update:**\n- src/api/data-sources/home-assistant.ts (line 36 - JSDoc example)\n- .env.example (if Home Assistant URL example exists)\n\n**Changes needed:**\n- Replace ws://homeassistant.local:8123 with wss://homeassistant.local:8123\n- Add note about TLS/SSL certificate requirements\n- Consider adding runtime warning in production mode if ws:// detected","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-11-24T07:02:44.112893297Z","updated_at":"2025-11-25T00:28:39.585567129Z","closed_at":"2025-11-25T00:28:39.585567129Z","labels":["documentation","security"]}
{"id":"clack-b5o","title":"Epic 1: Core Type Definitions \u0026 Interfaces","description":"Establish foundational types and interfaces for the content generation system including ContentGenerator interface, GenerationContext, GeneratedContent, priority enums, and registration metadata types.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-26T22:14:23.159968843Z","updated_at":"2025-11-26T23:03:02.298835708Z","closed_at":"2025-11-26T23:03:02.298835708Z","labels":["content-system","foundation","types"]}
{"id":"clack-b7e","title":"Task 7.2: Update CLI generate command","description":"Update src/cli/commands/generate.ts to use ContentOrchestrator instead of legacy generator.","acceptance_criteria":"- Uses bootstrap() to initialize system\n- Calls orchestrator.generateAndSend()\n- Displays generated content and metadata\n- Error handling for all failure modes","status":"closed","priority":2,"issue_type":"task","assignee":"claude","created_at":"2025-11-26T22:17:15.203631631Z","updated_at":"2025-11-27T06:42:30.364626093Z","closed_at":"2025-11-27T06:42:30.364626093Z","dependencies":[{"issue_id":"clack-b7e","depends_on_id":"clack-f33","type":"parent-child","created_at":"2025-11-26T22:17:25.897185136Z","created_by":"daemon"},{"issue_id":"clack-b7e","depends_on_id":"clack-bra","type":"blocks","created_at":"2025-11-26T22:17:26.43973097Z","created_by":"daemon"}]}
{"id":"clack-bra","title":"Task 7.1: Create bootstrap function","description":"Create src/bootstrap.ts to wire all components together at application startup - config loading, AI providers, registry, orchestrator, event handler, and scheduler.","acceptance_criteria":"- bootstrap() async function\n- Loads configuration from env\n- Creates AI providers and ModelTierSelector\n- Creates and populates ContentRegistry\n- Creates ContentOrchestrator with dependencies\n- Creates and initializes EventHandler\n- Creates and starts CronScheduler\n- Returns { orchestrator, eventHandler, scheduler }\n- Integration test","status":"closed","priority":1,"issue_type":"task","assignee":"claude","created_at":"2025-11-26T22:17:15.052262381Z","updated_at":"2025-11-27T06:27:33.025908636Z","closed_at":"2025-11-27T06:27:33.025908636Z","dependencies":[{"issue_id":"clack-bra","depends_on_id":"clack-f33","type":"parent-child","created_at":"2025-11-26T22:17:25.732184094Z","created_by":"daemon"}]}
{"id":"clack-cji","title":"Task 1.3: Create ContentRegistration metadata type","description":"Add ContentRegistration interface with id, name, priority, modelTier, applyFrame, eventTriggerPattern, and tags fields.","acceptance_criteria":"- ContentRegistration interface complete\n- Optional fields have sensible defaults documented\n- eventTriggerPattern supports RegExp for P0 matching\n- Exported from types/index.ts","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-26T22:14:49.272548258Z","updated_at":"2025-11-26T23:02:56.325666386Z","closed_at":"2025-11-26T23:02:56.325666386Z","dependencies":[{"issue_id":"clack-cji","depends_on_id":"clack-b5o","type":"parent-child","created_at":"2025-11-26T22:14:57.876175845Z","created_by":"daemon"},{"issue_id":"clack-cji","depends_on_id":"clack-k7g","type":"blocks","created_at":"2025-11-26T22:14:58.177821804Z","created_by":"daemon"}]}
{"id":"clack-cpo","title":"Enhanced Content Schema with Status Column","description":"Update content table schema to support success/failure tracking and generator metadata.\n\n**Files to modify**:\n- `src/storage/models/content.ts` - Enhanced ContentRecord interface\n- `src/storage/migrations/001_initial_schema.sql` - Create migrations directory\n\n**New columns**: status (success/failed), generator_id, generator_name, priority, ai_model, model_tier, failed_over, primary_provider, primary_error, error_type, error_message, tokens_used\n\n**Indexes**: idx_generated_at, idx_status, idx_generator_id, idx_ai_provider","acceptance_criteria":"- Migration runs successfully\n- ContentModel CRUD operations work with new schema\n- Indexes created for analytics queries\n- TypeScript interface matches SQL schema","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-27T21:49:07.868927881Z","updated_at":"2025-11-27T21:49:07.868927881Z","labels":["database","schema"],"dependencies":[{"issue_id":"clack-cpo","depends_on_id":"clack-hsa","type":"blocks","created_at":"2025-11-27T21:49:31.637570044Z","created_by":"daemon"},{"issue_id":"clack-cpo","depends_on_id":"clack-hfu","type":"parent-child","created_at":"2025-11-27T21:49:35.255479713Z","created_by":"daemon"}]}
{"id":"clack-cqg","title":"Task 7.4: Add content:test CLI command","description":"Create src/cli/commands/content-test.ts to test a specific content generator by id.","acceptance_criteria":"- Accepts generator id as argument\n- Generates content without sending to Vestaboard\n- Displays generated text, metadata, timing\n- Shows validation results\n- Option to apply frame preview","status":"closed","priority":3,"issue_type":"task","assignee":"claude","created_at":"2025-11-26T22:17:15.561909256Z","updated_at":"2025-11-27T06:42:30.68799176Z","closed_at":"2025-11-27T06:42:30.68799176Z","dependencies":[{"issue_id":"clack-cqg","depends_on_id":"clack-f33","type":"parent-child","created_at":"2025-11-26T22:17:26.160059761Z","created_by":"daemon"},{"issue_id":"clack-cqg","depends_on_id":"clack-bra","type":"blocks","created_at":"2025-11-26T22:17:27.138277637Z","created_by":"daemon"}]}
{"id":"clack-d1q","title":"Update Configuration Loader","description":"Update src/config/env.ts to load HA variables, add validation for required variables, parse reconnection settings.","acceptance_criteria":"- Load HA variables in src/config/env.ts\n- Validation for required variables\n- Defaults for optional variables\n- Parse reconnection settings\n- WebSocket URL construction logic\n- Export HomeAssistantConfig from config module","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-24T00:18:51.975468168Z","updated_at":"2025-11-24T04:32:05.921835836Z","closed_at":"2025-11-24T04:32:05.921835836Z","dependencies":[{"issue_id":"clack-d1q","depends_on_id":"clack-wm7","type":"blocks","created_at":"2025-11-24T00:20:02.790752173Z","created_by":"daemon"},{"issue_id":"clack-d1q","depends_on_id":"clack-n94","type":"parent-child","created_at":"2025-11-24T04:19:50.711576301Z","created_by":"vscode"}]}
{"id":"clack-ddj","title":"Security Hardening","description":"Implement comprehensive security measures for the web server including security headers (helmet.js) and rate limiting to prevent brute force attacks and common web vulnerabilities.","acceptance_criteria":"- Security headers middleware configured (helmet.js)\n- Rate limiting implemented on all API endpoints\n- Tests verify security measures are active\n- Documentation updated with security policies","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-23T23:47:22.433898585Z","updated_at":"2025-11-26T04:49:56.298113548Z","closed_at":"2025-11-26T04:49:56.298113548Z","labels":["epic","security"]}
{"id":"clack-dho","title":"Task 3.6: Create NotificationGenerator base for P0 content","description":"Create src/content/generators/notification-generator.ts with abstract base for HA event-triggered notifications with eventPattern regex matching.","acceptance_criteria":"- Abstract class with eventPattern property\n- Abstract formatNotification(eventData) method\n- generate() extracts event data and formats\n- Unit tests for pattern matching","status":"closed","priority":1,"issue_type":"task","assignee":"claude","created_at":"2025-11-26T22:15:40.420961879Z","updated_at":"2025-11-27T01:50:44.131183462Z","closed_at":"2025-11-27T01:50:44.131183462Z","dependencies":[{"issue_id":"clack-dho","depends_on_id":"clack-6vv","type":"parent-child","created_at":"2025-11-26T22:15:50.79014505Z","created_by":"daemon"}]}
{"id":"clack-dib","title":"Vestaboard API Wrapper Implementation","description":"Implement complete Vestaboard Local API wrapper with:\n- Character code converter (pure functions)\n- HTTP client with retry logic and exponential backoff\n- VestaboardClient orchestrator with animation support\n- Production-grade error handling\n- 80%+ test coverage with live device test option","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-26T05:30:34.067447385Z","updated_at":"2025-11-26T06:12:35.616359343Z","closed_at":"2025-11-26T06:12:35.616359343Z"}
{"id":"clack-docs","title":"Update documentation for web server","description":"Update README.md with web server commands, architecture diagrams, API documentation, and development workflow. Add JSDoc comments to public APIs.","acceptance_criteria":"- [ ] README.md updated with web server section\n- [ ] Server commands documented (start, dev)\n- [ ] Architecture diagram for web/API layer\n- [ ] API endpoint documentation with request/response examples\n- [ ] Development workflow documented\n- [ ] JSDoc comments on public APIs\n- [ ] CLAUDE.md updated if needed\n- [ ] .env.example updated with WEB_SERVER_* variables","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-23T01:41:39.376710675Z","updated_at":"2025-11-26T04:51:53.30918488Z","dependencies":[{"issue_id":"clack-docs","depends_on_id":"clack-e2e","type":"blocks","created_at":"2025-11-23T04:14:46.002826927Z","created_by":"import"},{"issue_id":"clack-docs","depends_on_id":"clack-dor","type":"parent-child","created_at":"2025-11-23T23:47:44.647122929Z","created_by":"daemon"}]}
{"id":"clack-dor","title":"Web Server Development","description":"Build Express API backend for debugging web interface with full integration into main Clack Track application. Includes API routes, testing, documentation, and cleanup of legacy code.","acceptance_criteria":"- All API endpoints implemented and tested\n- Web server auto-starts with main app\n- E2E tests passing\n- Legacy vanilla JS code removed\n- Documentation updated\n- Production build working","status":"open","priority":2,"issue_type":"epic","created_at":"2025-11-23T23:47:22.243696877Z","updated_at":"2025-11-26T04:51:53.618866047Z","labels":["epic","web"]}
{"id":"clack-e2e","title":"End-to-end testing and validation","description":"Write comprehensive E2E tests for API endpoints, validate 80%+ test coverage, and verify production build works correctly.","design":"**E2E Test Scenarios:**\n1. GET /api/content/latest - returns latest content\n2. GET /api/content/history - returns content history with pagination\n3. POST /api/votes - submit quality vote\n4. GET /api/logs - returns debug logs\n\n**Validation:**\n- Run full test suite (unit + integration + e2e)\n- Verify 80%+ coverage threshold met\n- Production build test (npm run build \u0026\u0026 npm start)\n- API response validation","acceptance_criteria":"- [ ] E2E tests for all API endpoints in tests/e2e/\n- [ ] Full test suite passes (npm run test:all)\n- [ ] 80%+ coverage achieved for all code\n- [ ] Production build succeeds (npm run build)\n- [ ] API responds correctly in production mode\n- [ ] No server errors or warnings","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-23T01:41:33.871556297Z","updated_at":"2025-11-26T04:51:53.016019921Z","dependencies":[{"issue_id":"clack-e2e","depends_on_id":"clack-dor","type":"parent-child","created_at":"2025-11-23T23:47:42.960829428Z","created_by":"daemon"}]}
{"id":"clack-e4i","title":"Task 7.5: Create static fallback content files","description":"Create prompts/static/*.txt with initial fallback messages for P3 content.","acceptance_criteria":"- fallback-1.txt - Generic inspirational message\n- fallback-2.txt - Time-based greeting\n- fallback-3.txt - Welcome message\n- All fit 6x22 Vestaboard constraints\n- Uppercase, limited character set","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T22:17:16.142075465Z","updated_at":"2025-11-27T06:27:33.162777095Z","closed_at":"2025-11-27T06:27:33.162777095Z","dependencies":[{"issue_id":"clack-e4i","depends_on_id":"clack-f33","type":"parent-child","created_at":"2025-11-26T22:17:26.288888261Z","created_by":"daemon"}]}
{"id":"clack-e6l","title":"Task 3.1: Create base AIPromptGenerator abstract class","description":"Create src/content/generators/ai-prompt-generator.ts with abstract base class for AI-powered content. Implements ContentGenerator with retry logic for alternate provider fallback.","acceptance_criteria":"- Abstract class implementing ContentGenerator\n- Constructor accepts PromptLoader, ModelTierSelector, modelTier\n- Abstract getSystemPromptFile() and getUserPromptFile()\n- generate() with retry: preferred provider → alternate → throw\n- validate() checks prompt files exist\n- Unit tests with mocked AI providers","status":"closed","priority":1,"issue_type":"task","assignee":"claude","created_at":"2025-11-26T22:15:38.729578503Z","updated_at":"2025-11-27T01:34:01.208404471Z","closed_at":"2025-11-27T01:34:01.208404471Z","dependencies":[{"issue_id":"clack-e6l","depends_on_id":"clack-6vv","type":"parent-child","created_at":"2025-11-26T22:15:50.16142855Z","created_by":"daemon"}]}
{"id":"clack-erc","title":"Upgrade body-parser to 2.2.1 to patch CVE-2025-13466 (MEDIUM severity DoS vulnerability, CVSS 5.3)","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-25T21:18:29.14739476Z","updated_at":"2025-11-25T21:59:51.388492131Z","closed_at":"2025-11-25T21:59:51.388492131Z","comments":[{"id":1,"issue_id":"clack-erc","author":"vscode","text":"VULNERABILITY DETAILS:\n- Package: body-parser\n- Current Version: 2.2.0\n- CVE: CVE-2025-13466\n- CVSS Score: 5.3 (MEDIUM)\n- CWE: CWE-400 (Uncontrolled Resource Consumption)\n\nIMPACT:\n- Severity: MEDIUM (Availability impact only)\n- Exploitability: Network accessible, no privileges required\n- Affected: Availability (potential DoS when URL encoding is used)\n- Not affected: Confidentiality, Integrity\n\nREMEDIATION:\nUpgrade body-parser from 2.2.0 to 2.2.1\n\nAFFECTED CODE:\nWeb server request parsing (Express middleware) - indirect dependency through body-parser\n\nVERIFICATION:\n- Trivy scan: Vulnerability confirmed (exit code 0)\n- npm audit: 1 moderate vulnerability reported\n- Fix available: Yes (version 2.2.1)\n\nDISCOVERED DURING:\nSecurity audit for task clack-201 (test isolation fix)\n\nPRIORITY RATIONALE:\nP2 - Non-critical path, fix available, moderate severity, DoS impact only","created_at":"2025-11-25T21:18:37Z"}]}
{"id":"clack-exj","title":"Fix singleton pattern test isolation in API routes","description":"Route handlers (voting.ts, content.ts, logs.ts) use singleton pattern with lazy initialization (getVoteRepository, getContentRepository, getLogModel). This causes test isolation failures because mock implementations only affect the first test - subsequent tests reuse the cached singleton instance.\n\nRoot Cause: Singleton getters cache instances on first call. Jest mock implementations cannot replace cached instances between tests.\n\nImpact: 23 tests failed in clack-002-api-routes validation (5 in voting.test.ts, 5 in content.test.ts, 13 in logs.test.ts)\n\nFiles Affected:\n- src/web/routes/voting.ts (getVoteRepository singleton)\n- src/web/routes/content.ts (getContentRepository singleton)\n- src/web/routes/logs.ts (getLogModel singleton)","design":"Solution Options:\n1. Add test helper to reset singletons between tests (quick fix)\n2. Refactor routes to accept optional dependency injection parameters (better architecture)\n3. Create factory functions that accept optional instances for testing (minimal change)\n\nRecommended: Option 2 (dependency injection) for better testability and SOLID compliance","acceptance_criteria":"- All 23 failing tests pass after fix\n- Test isolation verified (mocks work correctly in all tests)\n- No regression in existing functionality\n- Linting and TypeScript compilation still pass","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-11-24T15:46:13.12764843Z","updated_at":"2025-11-26T00:27:53.992347047Z","closed_at":"2025-11-26T00:27:53.992347047Z","labels":["architecture","bug","testing"]}
{"id":"clack-f33","title":"Epic 7: Application Bootstrap \u0026 CLI","description":"Wire everything together at application startup. Bootstrap function, CLI commands (generate, content:list, content:test), and static fallback files.","status":"closed","priority":1,"issue_type":"epic","assignee":"claude","created_at":"2025-11-26T22:14:24.887687052Z","updated_at":"2025-11-27T07:13:12.366001293Z","closed_at":"2025-11-27T07:13:12.366001293Z","labels":["bootstrap","cli","content-system"],"dependencies":[{"issue_id":"clack-f33","depends_on_id":"clack-zoy","type":"blocks","created_at":"2025-11-26T22:14:35.627235918Z","created_by":"daemon"}]}
{"id":"clack-fjv","title":"The Flip Side - historical messages page","description":"Build scrollable history page showing past Clack Track messages with metadata (prompt name, AI provider, timestamp) and voting capability for each record.","design":"**Components:**\n1. ContentHistoryCard - Compact Vestaboard preview + metadata badges\n2. HistoryList - Vertical list with pagination\n3. FlipSidePage - Fetches history, handles voting\n\n**Metadata Display:**\n- AI Provider badge (OpenAI/Anthropic)\n- Timestamp (relative format)\n- Content type (major/minor)\n- Prompt name from metadata\n\n**Features:**\n- Pagination (20 items, \"Load More\" button)\n- Voting on historical items\n- Card expansion to full-size preview\n- Responsive layout (1/2/3 columns)","acceptance_criteria":"- [ ] ContentHistoryCard displays all metadata correctly\n- [ ] Compact Vestaboard preview renders properly\n- [ ] AI provider badge shows correct provider\n- [ ] Timestamp in user-friendly format\n- [ ] Voting works for historical items\n- [ ] Pagination loads 20 items at a time\n- [ ] \"Load More\" button when more items available\n- [ ] Empty state when no history\n- [ ] Loading skeleton during fetch\n- [ ] Responsive layout (1/2/3 columns)\n- [ ] Unit tests with 80%+ coverage","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-26T05:05:08.075919262Z","updated_at":"2025-11-26T05:05:08.075919262Z","labels":["frontend","ui","web"],"dependencies":[{"issue_id":"clack-fjv","depends_on_id":"clack-dor","type":"parent-child","created_at":"2025-11-26T05:05:20.589953753Z","created_by":"daemon"},{"issue_id":"clack-fjv","depends_on_id":"clack-ias","type":"blocks","created_at":"2025-11-26T05:05:30.555702758Z","created_by":"daemon"}]}
{"id":"clack-foo","title":"Generator Output Validation","description":"Add strict validation to content generators to fail and trigger regeneration when content violates Vestaboard constraints (line count, character limits, invalid characters). Currently invalid content is silently truncated/fixed during frame decoration - we need to fail at the generator level instead.","acceptance_criteria":"- Generators that produce invalid content trigger P3 fallback\n- content:test CLI shows user prompt sent to LLM\n- content:test CLI shows validation result (pass/fail with details)\n- Graceful degradation preserved for external content (non-generator)","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-27T20:02:50.290187054Z","updated_at":"2025-11-27T21:34:23.305212013Z","closed_at":"2025-11-27T21:34:23.305212013Z"}
{"id":"clack-gpc","title":"Create ContentValidationError type","description":"Add ContentValidationError class to src/types/errors.ts. This is a non-retryable error that will be thrown when generator output validation fails.","design":"Add to src/types/errors.ts:\n```typescript\nexport class ContentValidationError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = 'ContentValidationError';\n  }\n}\n```","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-27T20:03:09.735213049Z","updated_at":"2025-11-27T20:14:22.257141971Z","closed_at":"2025-11-27T20:14:22.257141971Z","dependencies":[{"issue_id":"clack-gpc","depends_on_id":"clack-foo","type":"parent-child","created_at":"2025-11-27T20:03:22.958526139Z","created_by":"daemon"}]}
{"id":"clack-hfu","title":"Minor Updates with Database Persistence","description":"Enable minute-by-minute frame updates (time/weather) on Vestaboard while preserving content from the last major update. Store major update content and failures in MySQL for future web interface analytics.\n\n## Key Decisions\n- **Database**: MySQL for long-term scalability\n- **Storage scope**: Major updates only (minor use in-memory cache)\n- **Failure tracking**: Status column in content table\n- **Error handling**: Basic with throttled logging\n\n## Architecture\nMajor Update: ContentOrchestrator → Generate → Save to MySQL → Cache → Send\nMinor Update: CronScheduler → Check cache → Skip if full-frame → Apply frame → Send","status":"in_progress","priority":1,"issue_type":"epic","created_at":"2025-11-27T21:48:26.777316084Z","updated_at":"2025-11-28T01:43:08.90787963Z"}
{"id":"clack-hrm","title":"Task 7.3: Add content:list CLI command","description":"Create src/cli/commands/content-list.ts to list all registered content generators with their metadata.","acceptance_criteria":"- Lists all registered generators\n- Shows id, name, priority, modelTier, applyFrame\n- Grouped by priority (P0, P2, P3)\n- Table format output","status":"closed","priority":3,"issue_type":"task","assignee":"claude","created_at":"2025-11-26T22:17:15.352901631Z","updated_at":"2025-11-27T06:42:30.526346468Z","closed_at":"2025-11-27T06:42:30.526346468Z","dependencies":[{"issue_id":"clack-hrm","depends_on_id":"clack-f33","type":"parent-child","created_at":"2025-11-26T22:17:26.01516847Z","created_by":"daemon"},{"issue_id":"clack-hrm","depends_on_id":"clack-bra","type":"blocks","created_at":"2025-11-26T22:17:26.597218012Z","created_by":"daemon"}]}
{"id":"clack-hsa","title":"Install MySQL Driver and Database Abstraction","description":"Install mysql2 package and implement MySQL-compatible Database class.\n\n**Files to modify**:\n- `package.json` - Add `mysql2` dependency\n- `src/storage/database.ts` - Replace in-memory with MySQL implementation\n- `src/config/env.ts` - Parse DATABASE_URL\n\n**Key implementation**:\n```typescript\nimport mysql from 'mysql2/promise';\n\nexport class Database {\n  private pool: mysql.Pool;\n  async connect(): Promise\u003cvoid\u003e;\n  async run(sql: string, params?: unknown[]): Promise\u003c{ changes: number }\u003e;\n  async all\u003cT\u003e(sql: string, params?: unknown[]): Promise\u003cT[]\u003e;\n  async get\u003cT\u003e(sql: string, params?: unknown[]): Promise\u003cT | null\u003e;\n  async close(): Promise\u003cvoid\u003e;\n}\n```","acceptance_criteria":"- Database class connects to MySQL\n- Basic CRUD operations work\n- Connection pool with proper cleanup\n- Tests pass with real MySQL connection","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-27T21:49:06.305044421Z","updated_at":"2025-11-28T02:27:16.323090758Z","closed_at":"2025-11-28T02:27:16.323090758Z","labels":["database"],"dependencies":[{"issue_id":"clack-hsa","depends_on_id":"clack-kkr","type":"blocks","created_at":"2025-11-27T21:49:31.517997003Z","created_by":"daemon"},{"issue_id":"clack-hsa","depends_on_id":"clack-hfu","type":"parent-child","created_at":"2025-11-27T21:49:34.369976629Z","created_by":"daemon"}]}
{"id":"clack-ias","title":"Create non-functional mock UI for all pages","description":"Build static React UI mockups for Welcome, History, Account, and Login pages using shadcn components and placeholder data to demonstrate mobile-responsive layout.","design":"**Routing Setup:**\n- BrowserRouter in main.tsx\n- Routes: / (welcome), /flipside (history), /account, /login\n\n**Page Mockups (Static - No API):**\n1. Welcome (/) - Vestaboard preview + vote buttons with placeholder content\n2. The Flip Side (/flipside) - List of 5 placeholder content records with metadata\n3. Account (/account) - Profile info + passkey list with placeholder data\n4. Login (/login) - \"Sign in with Passkey\" button (non-functional)\n\n**Layout Components:**\n- Navigation.tsx - Mobile hamburger (Sheet) + desktop nav bar\n- PageLayout.tsx - Wrapper with navigation + responsive container\n\n**Feature Components:**\n- VestaboardPreview.tsx - 6×22 character grid, split-flap aesthetic\n- ContentCard.tsx - Reusable card for content items\n- VotingButtons.tsx - Thumbs up/down buttons\n\n**Placeholder Data:**\n- lib/mockData.ts - Mock arrays matching API response types\n\n**Mobile Responsiveness:**\n- 320px minimum viewport\n- Touch-friendly buttons (44px min)\n- Responsive breakpoints (mobile/tablet/desktop)","acceptance_criteria":"- [ ] React Router configured with all 4 routes\n- [ ] Navigation works on mobile (hamburger) and desktop (horizontal)\n- [ ] Welcome page displays Vestaboard preview with placeholder content\n- [ ] History page shows placeholder content list with metadata\n- [ ] Account page shows placeholder profile and passkey list\n- [ ] Login page shows passkey button (non-functional)\n- [ ] All pages responsive on mobile (320px), tablet, desktop\n- [ ] VestaboardPreview renders 6×22 character grid correctly\n- [ ] All interactive elements have visible focus states\n- [ ] No console errors\n- [ ] Tests pass, linting passes","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-26T05:05:07.200027636Z","updated_at":"2025-11-26T05:05:07.200027636Z","labels":["frontend","ui","web"],"dependencies":[{"issue_id":"clack-ias","depends_on_id":"clack-dor","type":"parent-child","created_at":"2025-11-26T05:05:20.31535342Z","created_by":"daemon"},{"issue_id":"clack-ias","depends_on_id":"clack-9mi","type":"blocks","created_at":"2025-11-26T05:05:30.334591925Z","created_by":"daemon"}]}
{"id":"clack-iic","title":"Full-Frame Skip Logic for Minor Updates","description":"Skip minor updates when cached content is full-frame (outputMode: 'layout').\n\n**Files to modify**:\n- `src/content/generators/minor-update.ts` - Add `shouldSkip()` method\n- `src/scheduler/cron.ts` - Check skip before generating\n\n**Implementation**:\n```typescript\n// MinorUpdateGenerator\nshouldSkip(): boolean {\n  const cached = this.orchestrator.getCachedContent();\n  return cached?.outputMode === 'layout';\n}\n\n// CronScheduler.runMinorUpdate()\nif (this.minorUpdateGenerator.shouldSkip()) {\n  log('Minor update skipped - cached content is full frame');\n  return;\n}\n```","acceptance_criteria":"- Full-frame content (outputMode: 'layout') skips minor update\n- Text content (outputMode: 'text') gets frame refresh\n- Skip is logged\n- No Vestaboard API call when skipped","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-27T21:49:11.431705466Z","updated_at":"2025-11-27T21:49:11.431705466Z","labels":["feature"],"dependencies":[{"issue_id":"clack-iic","depends_on_id":"clack-hfu","type":"parent-child","created_at":"2025-11-27T21:49:45.696913843Z","created_by":"daemon"}]}
{"id":"clack-isp","title":"Replace VestaboardClient Stub with Factory-Created Client","description":"Update existing usage sites (CronScheduler, EventHandler) to use factory-created VestaboardClient instead of stub. Delete old src/api/vestaboard.ts stub file.","design":"## Migration Strategy\n1. Update imports from 'src/api/vestaboard.js' to 'src/api/vestaboard/index.js'\n2. Use createVestaboardClient(config) factory\n3. Update dependency injection in schedulers\n4. Delete old stub file\n5. Update all tests that use VestaboardClient\n\nUsage sites:\n- src/scheduler/cron.ts\n- src/scheduler/event-handler.ts\n- src/index.ts (initialization)","acceptance_criteria":"- src/scheduler/cron.ts imports from src/api/vestaboard/index.ts\n- src/scheduler/event-handler.ts imports from src/api/vestaboard/index.ts\n- src/index.ts creates client using createVestaboardClient(config)\n- Config loaded from src/config/env.ts\n- Old src/api/vestaboard.ts stub file deleted\n- VestaboardClient interface updated in all usage sites\n- All existing tests updated to use new client structure\n- Integration tests verify CronScheduler works with real client\n- Integration tests verify EventHandler works with real client\n- All tests pass\n- No breaking changes to public API","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-26T05:26:19.424796128Z","updated_at":"2025-11-26T05:26:19.424796128Z","dependencies":[{"issue_id":"clack-isp","depends_on_id":"clack-nsx","type":"blocks","created_at":"2025-11-26T05:26:19.425515378Z","created_by":"daemon"},{"issue_id":"clack-isp","depends_on_id":"clack-odi","type":"blocks","created_at":"2025-11-26T05:26:19.426276794Z","created_by":"daemon"}]}
{"id":"clack-iwr","title":"Implement Auto-Reconnection Logic","description":"Create reconnection manager with exponential backoff, handle WebSocket close events, implement graceful degradation (log warnings, don't crash app).","acceptance_criteria":"- Reconnection manager with exponential backoff\n- Max retry attempts (configurable)\n- Reconnection delay configuration\n- Resubscribe to events after reconnection\n- Connection lifecycle event handlers\n- Graceful degradation","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-24T00:18:38.421877967Z","updated_at":"2025-11-24T05:31:20.035430009Z","closed_at":"2025-11-24T05:31:20.035430009Z","dependencies":[{"issue_id":"clack-iwr","depends_on_id":"clack-ar9","type":"blocks","created_at":"2025-11-24T00:19:50.850865709Z","created_by":"daemon"},{"issue_id":"clack-iwr","depends_on_id":"clack-0nr","type":"parent-child","created_at":"2025-11-24T04:18:56.798581137Z","created_by":"vscode"}]}
{"id":"clack-ix1","title":"Add validation call to orchestrator","description":"Insert validateGeneratorOutput() call in src/content/orchestrator.ts after generateWithRetry() returns, inside the try block. This ensures validation failures trigger P3 fallback.","design":"In generateAndSend() method, after line 151:\n```typescript\ntry {\n  content = await generateWithRetry(...);\n  \n  // NEW: Validate generator output\n  validateGeneratorOutput(content);\n  \n} catch (error) {\n  console.warn('Generator failed, using P3 fallback:', \n    error instanceof Error ? error.message : 'Unknown error');\n  content = await this.fallbackGenerator.generate(context);\n}\n```","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-27T20:03:11.286660633Z","updated_at":"2025-11-27T20:30:43.376926092Z","closed_at":"2025-11-27T20:30:43.376926092Z","dependencies":[{"issue_id":"clack-ix1","depends_on_id":"clack-foo","type":"parent-child","created_at":"2025-11-27T20:03:23.16172118Z","created_by":"daemon"},{"issue_id":"clack-ix1","depends_on_id":"clack-rnx","type":"blocks","created_at":"2025-11-27T20:03:30.158059753Z","created_by":"daemon"}]}
{"id":"clack-jc1","title":"Create Test Fixtures for Vestaboard API","description":"Create JSON fixtures with realistic Vestaboard API responses, character code examples, and error scenarios for comprehensive testing.","design":"## Fixture Categories\nReference: tests/fixtures/openai-responses.json\n\n1. Success responses (message sent)\n2. Error responses (auth, invalid message)\n3. Character code examples (hello world, motivational quotes)\n4. getCurrentMessage responses\n5. Edge cases (empty messages, full board)\n\nAll fixtures based on official Vestaboard API documentation.","acceptance_criteria":"- tests/fixtures/vestaboard-responses.json created\n- sendMessage.success fixture\n- sendMessage.authenticationError fixture\n- sendMessage.invalidMessage fixture\n- getCurrentMessage.success fixture with 6×22 character array\n- characterCodes.helloWorld example (6×22 array)\n- characterCodes.motivational example (multi-line centered text)\n- characterCodes.empty fixture (all zeros)\n- Fixtures match real Vestaboard API response format\n- Character codes validated against official documentation\n- JSON properly formatted and linted","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-26T05:25:07.710999386Z","updated_at":"2025-11-26T23:08:41.885048171Z","closed_at":"2025-11-26T23:08:41.885048171Z","dependencies":[{"issue_id":"clack-jc1","depends_on_id":"clack-7tb","type":"blocks","created_at":"2025-11-26T05:25:07.711746428Z","created_by":"daemon"},{"issue_id":"clack-jc1","depends_on_id":"clack-2jo","type":"parent-child","created_at":"2025-11-26T23:06:05.164965293Z","created_by":"daemon"}]}
{"id":"clack-jxm","title":"Task 1.1: Create ContentGenerator interface and core types","description":"Create src/types/content-generator.ts with ContentGenerator interface, GenerationContext, GeneratedContent, ValidationResult types.","acceptance_criteria":"- ContentGenerator interface with generate() and validate() methods\n- GenerationContext with eventData, previousContent, updateType, timestamp\n- GeneratedContent with text, layout, outputMode, metadata\n- ValidationResult with valid boolean and optional errors array\n- Full JSDoc documentation\n- Unit tests with 80%+ coverage","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-26T22:14:49.00851055Z","updated_at":"2025-11-26T23:02:56.091117053Z","closed_at":"2025-11-26T23:02:56.091117053Z","dependencies":[{"issue_id":"clack-jxm","depends_on_id":"clack-b5o","type":"parent-child","created_at":"2025-11-26T22:14:57.682543679Z","created_by":"daemon"}]}
{"id":"clack-k7g","title":"Task 1.2: Add ContentPriority and ModelTier enums","description":"Extend src/types/content-generator.ts with ContentPriority enum (NOTIFICATION=0, NORMAL=2, FALLBACK=3) and ModelTier enum (LIGHT, MEDIUM, HEAVY).","acceptance_criteria":"- ContentPriority enum with P0, P2, P3 values\n- ModelTier enum with light/medium/heavy\n- Exported from types/index.ts\n- Unit tests","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-26T22:14:49.135336216Z","updated_at":"2025-11-26T23:02:56.208616803Z","closed_at":"2025-11-26T23:02:56.208616803Z","dependencies":[{"issue_id":"clack-k7g","depends_on_id":"clack-b5o","type":"parent-child","created_at":"2025-11-26T22:14:57.778717137Z","created_by":"daemon"},{"issue_id":"clack-k7g","depends_on_id":"clack-jxm","type":"blocks","created_at":"2025-11-26T22:14:58.027528929Z","created_by":"daemon"}]}
{"id":"clack-k7s","title":"Task 3.2: Create concrete AI generators (Motivational, News, Weather)","description":"Create src/content/generators/ai/ directory with MotivationalGenerator, NewsSummaryGenerator, WeatherFocusGenerator extending AIPromptGenerator.","acceptance_criteria":"- MotivationalGenerator with motivational.txt prompts\n- NewsSummaryGenerator with news-summary.txt prompts\n- WeatherFocusGenerator with weather-focus.txt prompts\n- Each specifies appropriate model tier\n- Unit tests for each generator","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T22:15:39.010098211Z","updated_at":"2025-11-27T02:43:07.218708542Z","closed_at":"2025-11-27T02:43:07.218708542Z","dependencies":[{"issue_id":"clack-k7s","depends_on_id":"clack-6vv","type":"parent-child","created_at":"2025-11-26T22:15:50.277523592Z","created_by":"daemon"},{"issue_id":"clack-k7s","depends_on_id":"clack-e6l","type":"blocks","created_at":"2025-11-26T22:15:50.983388551Z","created_by":"daemon"}]}
{"id":"clack-ke0","title":"Passkey-only login screen","description":"Implement WebAuthn/passkey authentication login screen with browser compatibility detection. Login-only functionality without registration.","design":"**WebAuthn Implementation:**\n- @simplewebauthn/browser for client\n- @simplewebauthn/server for backend\n- Challenge/response flow\n\n**Backend Endpoints:**\n- POST /api/auth/login/start - Returns challenge\n- POST /api/auth/login/verify - Verifies response, returns session\n\n**UI Components:**\n- LoginScreen - Full-screen centered card\n- PasskeyButton - \"Sign in with Passkey\"\n- Browser support detection with error message\n\n**State Management:**\n- AuthContext (user, token, isAuthenticated)\n- Session token in httpOnly cookie\n- Logout functionality\n\n**Security:**\n- Rate limiting on auth endpoints\n- HTTPS required for WebAuthn\n- Short-lived session tokens","acceptance_criteria":"- [ ] Login screen renders with \"Sign in with Passkey\" button\n- [ ] Browser compatibility check shows error on unsupported browsers\n- [ ] Clicking button triggers WebAuthn passkey ceremony\n- [ ] Successful auth stores session and redirects\n- [ ] Failed auth shows user-friendly error\n- [ ] Cancelled prompt returns to login without error\n- [ ] Backend implements challenge/response flow\n- [ ] Rate limiting on auth endpoints\n- [ ] AuthContext provides isAuthenticated, user, login, logout\n- [ ] All WebAuthn operations mocked in tests\n- [ ] 80%+ test coverage\n- [ ] Mobile responsive (iOS Safari, Android Chrome)\n- [ ] NO password fields or registration visible","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-26T05:05:08.487026137Z","updated_at":"2025-11-26T05:05:08.487026137Z","labels":["auth","ui","web"],"dependencies":[{"issue_id":"clack-ke0","depends_on_id":"clack-dor","type":"parent-child","created_at":"2025-11-26T05:05:20.738221628Z","created_by":"daemon"},{"issue_id":"clack-ke0","depends_on_id":"clack-ias","type":"blocks","created_at":"2025-11-26T05:05:30.674863383Z","created_by":"daemon"}]}
{"id":"clack-kgt","title":"Database Integration with Bootstrap","description":"Initialize database connection in bootstrap and inject into orchestrator.\n\n**Files to modify**:\n- `src/bootstrap.ts` - Add database initialization\n- `src/content/orchestrator.ts` - Accept ContentRepository in config\n\n**Bootstrap changes**:\n```typescript\nconst database = new Database();\nawait database.connect();\nconst contentModel = new ContentModel(database);\nconst contentRepository = new ContentRepository(contentModel);\n\nconst orchestrator = new ContentOrchestrator({\n  // ... existing config\n  contentRepository,\n});\n```","acceptance_criteria":"- Database connects during bootstrap\n- ContentRepository injected into orchestrator\n- Graceful shutdown closes database connection\n- Error handling for database connection failures","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-27T21:49:09.578841715Z","updated_at":"2025-11-27T21:49:09.578841715Z","labels":["integration"],"dependencies":[{"issue_id":"clack-kgt","depends_on_id":"clack-cpo","type":"blocks","created_at":"2025-11-27T21:49:31.905905086Z","created_by":"daemon"},{"issue_id":"clack-kgt","depends_on_id":"clack-6pj","type":"blocks","created_at":"2025-11-27T21:49:32.096806628Z","created_by":"daemon"},{"issue_id":"clack-kgt","depends_on_id":"clack-hfu","type":"parent-child","created_at":"2025-11-27T21:49:45.468938509Z","created_by":"daemon"}]}
{"id":"clack-kkr","title":"MySQL Devcontainer Setup","description":"Add MySQL service to devcontainer configuration. User must rebuild container after this task.\n\n**Files to modify**:\n- `.devcontainer/devcontainer.json` - Add MySQL feature or docker-compose service\n- `.devcontainer/docker-compose.yml` - Create if needed for MySQL service\n- `.env.example` - Add MySQL connection variables\n\n**Environment variables**:\n```env\nDATABASE_URL=mysql://root:devpassword@localhost:3306/clack_track\nDATABASE_TYPE=mysql\n```\n\n**REQUIRES USER INTERACTION**: User must rebuild devcontainer after changes.","acceptance_criteria":"- MySQL service running in devcontainer\n- Connection verified with `mysql -u root -p`\n- Environment variables documented in .env.example","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-27T21:49:05.959026796Z","updated_at":"2025-11-28T01:47:41.705495506Z","closed_at":"2025-11-28T01:47:41.705495506Z","labels":["blocking","infrastructure"],"dependencies":[{"issue_id":"clack-kkr","depends_on_id":"clack-hfu","type":"parent-child","created_at":"2025-11-27T21:49:33.78414067Z","created_by":"daemon"}]}
{"id":"clack-ko4","title":"Implement HTTP Client for Vestaboard Local API","description":"Create HTTP communication layer using fetch API to send messages to Vestaboard device via Local API. Handles authentication, error responses, and connection validation.","design":"## Vestaboard Local API\n- Endpoint: POST http://vestaboard.local:7000/local-api/message\n- Header: X-Vestaboard-Local-Api-Key\n- Body: { \"characters\": [[...], [...], ...] } or [[...], [...], ...]\n- Dimensions: 6 rows × 22 columns\n\n## Error Handling\n- 401/403 → VestaboardAuthenticationError\n- 400 → VestaboardInvalidMessageError\n- Network errors → VestaboardConnectionError\n- Timeout support (configurable)\n\nReferences:\n- https://docs.vestaboard.com/docs/local-api/endpoints/","acceptance_criteria":"- src/api/vestaboard/http-client.ts created\n- VestaboardHTTPClientImpl class implements VestaboardHTTPClient interface\n- sendMessage(characterCodes: number[][]): Promise\u0026lt;VestaboardResponse\u0026gt; method\n- getCurrentMessage(): Promise\u0026lt;VestaboardResponse\u0026gt; method\n- validateConnection(): Promise\u0026lt;boolean\u0026gt; method\n- X-Vestaboard-Local-Api-Key header injection\n- Content-Type: application/json header\n- Proper request body formatting\n- Error handling for 401, 403, 400, timeout, network errors\n- Response parsing and validation\n- Timeout configuration support\n- Exported from src/api/vestaboard/index.ts","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-26T05:24:28.254797048Z","updated_at":"2025-11-26T23:07:07.163717169Z","closed_at":"2025-11-26T23:07:07.163717169Z","dependencies":[{"issue_id":"clack-ko4","depends_on_id":"clack-7tb","type":"blocks","created_at":"2025-11-26T05:24:28.255530673Z","created_by":"daemon"},{"issue_id":"clack-ko4","depends_on_id":"clack-2jo","type":"parent-child","created_at":"2025-11-26T23:06:04.944084084Z","created_by":"daemon"}]}
{"id":"clack-lx1","title":"Task 2.3: Enhance AI provider factory with model override","description":"Modify src/api/ai/index.ts createAIProvider() to accept optional model parameter for tier-based model selection.","acceptance_criteria":"- createAIProvider(type, apiKey, model?) signature\n- Model override passed to provider constructor\n- Backward compatible (model optional)\n- Updated unit tests","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-26T22:15:11.390095546Z","updated_at":"2025-11-26T23:55:51.22660755Z","closed_at":"2025-11-26T23:55:51.22660755Z","dependencies":[{"issue_id":"clack-lx1","depends_on_id":"clack-adr","type":"parent-child","created_at":"2025-11-26T22:15:18.815226091Z","created_by":"daemon"},{"issue_id":"clack-lx1","depends_on_id":"clack-xtg","type":"blocks","created_at":"2025-11-26T22:15:19.039594466Z","created_by":"daemon"}]}
{"id":"clack-n94","title":"Configuration and Type Definitions","description":"Add environment configuration and TypeScript type definitions for Home Assistant integration.","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-11-24T00:14:50.550244334Z","updated_at":"2025-11-24T04:32:06.015988919Z","closed_at":"2025-11-24T04:32:06.015988919Z"}
{"id":"clack-nsx","title":"Create Factory Function and Public API","description":"Implement factory function to create configured Vestaboard clients, following the existing AI provider pattern. Creates index.ts as the public API entry point.","design":"## Factory Pattern (Consistent with AI Providers)\nReference: src/api/ai/index.ts\n\nFactory creates:\n1. HTTP client from config\n2. Character converter (default implementation)\n3. Vestaboard client with injected dependencies\n\n## Public API Exports\n- createVestaboardClient() factory\n- All interfaces (VestaboardSender, etc.)\n- All error types\n- Helper functions if needed","acceptance_criteria":"- src/api/vestaboard/index.ts created\n- createVestaboardClient(config: VestaboardConfig): VestaboardClient factory function\n- Factory instantiates HTTP client from config\n- Factory creates default character converter\n- Factory injects both into VestaboardClient\n- Config validation in factory\n- Re-exports all public interfaces and types\n- Re-exports all error classes\n- Re-exports character converter functions for testing\n- Pattern matches src/api/ai/index.ts structure","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-26T05:24:49.130064294Z","updated_at":"2025-11-26T05:24:49.130064294Z","dependencies":[{"issue_id":"clack-nsx","depends_on_id":"clack-745","type":"blocks","created_at":"2025-11-26T05:24:49.131215627Z","created_by":"daemon"}]}
{"id":"clack-nux","title":"Task 4.1: Create ContentRegistry singleton class","description":"Create src/content/registry/content-registry.ts with singleton pattern for registering and managing content generators.","acceptance_criteria":"- Singleton getInstance() pattern\n- register(registration, generator) method\n- unregister(id) method\n- getAll(), getById(), getByPriority(), getByEventPattern() methods\n- Map-based storage\n- Unit tests with 80%+ coverage","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-26T22:16:05.935569335Z","updated_at":"2025-11-27T04:11:31.780117636Z","closed_at":"2025-11-27T04:11:31.780117636Z","dependencies":[{"issue_id":"clack-nux","depends_on_id":"clack-4lg","type":"parent-child","created_at":"2025-11-26T22:16:15.123065714Z","created_by":"daemon"}]}
{"id":"clack-odi","title":"Update TextLayoutFormatter to Use Character Converter","description":"Integrate character converter into TextLayoutFormatter to populate characterCodes field in VestaboardLayout. Updates existing formatter stub with real implementation.","design":"## Integration Points\nCurrent: src/content/formatters/text-layout.ts (stub)\n\nChanges needed:\n1. Inject character converter via constructor\n2. Use converter in format() method\n3. Populate layout.characterCodes field\n4. Keep text wrapping and centering logic\n\n## Dependency Injection\nConstructor receives CharacterConverter (or use default from factory)","acceptance_criteria":"- src/content/formatters/text-layout.ts updated\n- Constructor accepts CharacterConverter parameter (optional, defaults to factory-created)\n- format() method uses converter.layoutToCharacterCodes()\n- VestaboardLayout.characterCodes field populated\n- Text wrapping logic implemented (22 chars max per row)\n- Text centering logic works with centerText() helper\n- 6-row limit enforced\n- All existing tests updated to use character converter\n- New tests added for characterCodes population\n- Integration with ContentGenerator works\n- 80%+ test coverage maintained","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-26T05:26:10.097983471Z","updated_at":"2025-11-26T05:26:10.097983471Z","dependencies":[{"issue_id":"clack-odi","depends_on_id":"clack-u7h","type":"blocks","created_at":"2025-11-26T05:26:10.099746846Z","created_by":"daemon"},{"issue_id":"clack-odi","depends_on_id":"clack-nsx","type":"blocks","created_at":"2025-11-26T05:26:10.100602596Z","created_by":"daemon"}]}
{"id":"clack-p30","title":"Add Error Handling and Logging","description":"Define error types, add comprehensive logging for connection/events/errors, handle auth and network failures gracefully.","acceptance_criteria":"- Error types defined (AuthenticationError, ConnectionError, etc.)\n- Comprehensive logging (connection, events, errors)\n- Authentication failure handling\n- Network error handling\n- Debug logging option\n- Error scenarios documented","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-24T00:18:48.722613166Z","updated_at":"2025-11-24T05:41:51.395849134Z","closed_at":"2025-11-24T05:41:51.395849134Z","dependencies":[{"issue_id":"clack-p30","depends_on_id":"clack-ar9","type":"blocks","created_at":"2025-11-24T00:19:59.323888546Z","created_by":"daemon"},{"issue_id":"clack-p30","depends_on_id":"clack-iwr","type":"blocks","created_at":"2025-11-24T00:20:00.37478313Z","created_by":"daemon"},{"issue_id":"clack-p30","depends_on_id":"clack-2w5","type":"blocks","created_at":"2025-11-24T00:20:01.486984381Z","created_by":"daemon"},{"issue_id":"clack-p30","depends_on_id":"clack-0nr","type":"parent-child","created_at":"2025-11-24T04:19:17.240498424Z","created_by":"vscode"}]}
{"id":"clack-pcq","title":"Configure frameless PWA with push notification support","description":"Transform the React app into a Progressive Web App with standalone/frameless display mode, offline capability, and push notification support for content updates.","design":"**Web App Manifest (manifest.json):**\n- display: \"standalone\" (frameless, no browser chrome)\n- orientation: \"portrait\"\n- theme_color and background_color matching app theme\n- App icons (192x192, 512x512, maskable)\n- shortcuts for quick actions\n- start_url: \"/\"\n\n**Service Worker:**\n- Use Vite PWA plugin (vite-plugin-pwa)\n- Workbox for caching strategies\n- Cache static assets (offline-first)\n- Network-first for API calls\n- Background sync for failed votes\n\n**Push Notifications:**\n- Web Push API with VAPID keys\n- Backend: POST /api/notifications/subscribe\n- Backend: POST /api/notifications/send (admin)\n- Notification types: new content, vote reminders\n- Permission request flow (non-intrusive)\n- Notification click handlers (open app to relevant page)\n\n**iOS Support:**\n- apple-mobile-web-app-capable meta tag\n- apple-mobile-web-app-status-bar-style: \"black-translucent\"\n- apple-touch-icon links\n- splash screen images\n\n**Android Support:**\n- Maskable icons for adaptive icon support\n- Install prompt handling (beforeinstallprompt)\n- Custom install UI\n\n**Backend Endpoints:**\n- POST /api/push/subscribe - Store push subscription\n- POST /api/push/unsubscribe - Remove subscription\n- POST /api/push/send - Send notification (admin)\n- Store subscriptions in database (new PushSubscription model)","acceptance_criteria":"- [ ] manifest.json configured with standalone display mode\n- [ ] App icons generated (192x192, 512x512, maskable)\n- [ ] Service worker registers and caches static assets\n- [ ] App works offline (cached pages load)\n- [ ] iOS meta tags for frameless display\n- [ ] Android install prompt handled gracefully\n- [ ] Push notification permission request UI\n- [ ] Backend stores push subscriptions\n- [ ] Push notifications received on mobile devices\n- [ ] Notification click opens app to correct page\n- [ ] \"Add to Home Screen\" works on iOS and Android\n- [ ] App launches without browser chrome (frameless)\n- [ ] Lighthouse PWA audit passes\n- [ ] Unit tests for service worker registration\n- [ ] 80%+ test coverage for new code","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-26T05:08:25.820341339Z","updated_at":"2025-11-26T05:08:25.820341339Z","labels":["pwa","ui","web"],"dependencies":[{"issue_id":"clack-pcq","depends_on_id":"clack-dor","type":"parent-child","created_at":"2025-11-26T05:08:32.295512384Z","created_by":"daemon"},{"issue_id":"clack-pcq","depends_on_id":"clack-ias","type":"blocks","created_at":"2025-11-26T05:08:32.397612634Z","created_by":"daemon"}]}
{"id":"clack-pds","title":"Expose prompts in GeneratedContent metadata","description":"Add systemPrompt and userPrompt fields to GeneratedContent metadata so the content:test CLI can display what was sent to the LLM.","design":"1. Update src/types/content-generator.ts - add to GenerationMetadata:\n   - systemPrompt?: string\n   - userPrompt?: string\n\n2. Update src/content/generators/ai-prompt-generator.ts - in generate() return:\n   - Include systemPrompt and formatted userPrompt in metadata","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-11-27T20:03:11.97062255Z","updated_at":"2025-11-27T20:14:22.428269221Z","closed_at":"2025-11-27T20:14:22.428269221Z","dependencies":[{"issue_id":"clack-pds","depends_on_id":"clack-foo","type":"parent-child","created_at":"2025-11-27T20:03:23.26776418Z","created_by":"daemon"}]}
{"id":"clack-ptb","title":"Add Usage Examples","description":"Create code examples for event subscription, state queries, service calls, and troubleshooting guide.","acceptance_criteria":"- Event subscription code examples\n- State query code examples\n- Service call code examples\n- Reconnection behavior documented\n- Troubleshooting guide\n- Common error scenarios documented","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T00:19:01.557195798Z","updated_at":"2025-11-26T01:01:15.915804251Z","closed_at":"2025-11-26T01:01:15.915804251Z","dependencies":[{"issue_id":"clack-ptb","depends_on_id":"clack-t51","type":"blocks","created_at":"2025-11-24T00:20:23.586792919Z","created_by":"daemon"},{"issue_id":"clack-ptb","depends_on_id":"clack-3my","type":"parent-child","created_at":"2025-11-24T04:21:05.807710794Z","created_by":"vscode"}]}
{"id":"clack-q4k","title":"Write Unit Tests for Character Converter","description":"Create comprehensive unit tests for pure character conversion functions. Target: 100% coverage (branches, functions, lines, statements). No mocks needed.","design":"## Test Coverage Areas\nPure function testing (no mocks):\n\n1. Letter conversion (A=1, Z=26)\n2. Number conversion (0=36, 1-9=27-35)\n3. Symbol conversion (!, @, #, etc.)\n4. Space and blank (0)\n5. Color codes (63-71)\n6. Uppercase normalization\n7. Invalid character handling\n8. Row conversion (string → number[])\n9. Layout conversion (VestaboardLayout → number[][])\n10. Edge cases (empty, long strings, null/undefined)","acceptance_criteria":"- tests/unit/api/vestaboard/character-converter.test.ts created\n- Test textToCharacterCode() with letters (A-Z → 1-26)\n- Test numbers (0 → 36, 1-9 → 27-35)\n- Test symbols (!, @, #, $, etc.)\n- Test space character (→ 0)\n- Test color codes (63-71)\n- Test uppercase normalization (a → A → 1)\n- Test invalid character error throwing\n- Test rowToCharacterCodes() with mixed content\n- Test layoutToCharacterCodes() with full 6×22 layout\n- Test edge cases (empty string, undefined, null)\n- 100% coverage achieved (branches, functions, lines, statements)\n- All tests pass\n- No mocks used (pure function testing)","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-26T05:25:18.545606502Z","updated_at":"2025-11-26T05:25:18.545606502Z","dependencies":[{"issue_id":"clack-q4k","depends_on_id":"clack-u7h","type":"blocks","created_at":"2025-11-26T05:25:18.546767211Z","created_by":"daemon"},{"issue_id":"clack-q4k","depends_on_id":"clack-jc1","type":"blocks","created_at":"2025-11-26T05:25:18.547691544Z","created_by":"daemon"}]}
{"id":"clack-r0g","title":"Task 5.2: Create FrameDecorator service","description":"Create src/content/frame/frame-decorator.ts wrapping existing frame generator for post-generation decoration with time/weather.","acceptance_criteria":"- Constructor accepts optional HomeAssistantClient and AIProvider\n- decorate(text, dateTime?) method\n- Wraps existing generateFrame() function\n- Returns FrameResult with layout and warnings\n- Graceful degradation if HA/AI unavailable\n- Unit tests","status":"closed","priority":1,"issue_type":"task","assignee":"claude","created_at":"2025-11-26T22:16:29.910541346Z","updated_at":"2025-11-27T05:11:16.441371254Z","closed_at":"2025-11-27T05:11:16.441371254Z","dependencies":[{"issue_id":"clack-r0g","depends_on_id":"clack-zoc","type":"parent-child","created_at":"2025-11-26T22:16:37.891673253Z","created_by":"daemon"}]}
{"id":"clack-rnx","title":"Implement validateGeneratorOutput() function","description":"Create comprehensive validation in src/utils/validators.ts that validates generator output against Vestaboard constraints. Returns detailed ValidationResult for CLI display AND throws ContentValidationError on failure for orchestrator integration.","design":"File: src/utils/validators.ts\n\nKey functions:\n- validateGeneratorOutput(content) - main entry point\n- validateTextContent(text) - for outputMode='text' (5 lines × 21 chars)\n- validateLayoutContent(layout) - for outputMode='layout' (6 rows × 22 cols, codes 0-69)\n- findInvalidCharacters(text) - check against VESTABOARD.SUPPORTED_CHARS\n\nValidationResult interface:\n- valid: boolean\n- lineCount: number\n- maxLineLength: number\n- invalidChars: string[]\n- errors: string[]\n\nAlso add FRAMED_MAX_ROWS=5 and FRAMED_MAX_COLS=21 to src/config/constants.ts","acceptance_criteria":"- Validates text mode: max 5 lines, max 21 chars/line, valid characters\n- Validates layout mode: 6×22 dimensions, codes 0-69\n- Returns detailed result for CLI display\n- Throws ContentValidationError on failure","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-11-27T20:03:10.115877174Z","updated_at":"2025-11-27T20:21:56.539191792Z","closed_at":"2025-11-27T20:21:56.539191792Z","dependencies":[{"issue_id":"clack-rnx","depends_on_id":"clack-foo","type":"parent-child","created_at":"2025-11-27T20:03:23.062846347Z","created_by":"daemon"},{"issue_id":"clack-rnx","depends_on_id":"clack-gpc","type":"blocks","created_at":"2025-11-27T20:03:30.046544919Z","created_by":"daemon"}]}
{"id":"clack-suz","title":"Create Mock Utilities for Testing","description":"Create mock factory functions for character converter, HTTP client, and Vestaboard client to enable comprehensive unit testing without real HTTP calls.","design":"## Mock Factory Pattern\nReference: tests/__mocks__/ai-providers.ts\n\nThree mock levels:\n1. Character converter mock (for testing orchestrator)\n2. HTTP client mock (for testing client)\n3. High-level client mock (for testing usage sites)\n\nEach mock supports:\n- Success scenarios\n- Failure scenarios\n- Custom behavior configuration\n- Message capture for assertions","acceptance_criteria":"- tests/__mocks__/vestaboard.ts created\n- MockCharacterConverterOptions interface defined\n- createMockCharacterConverter() factory function\n- MockVestaboardHTTPClientOptions interface defined\n- createMockVestaboardHTTPClient() factory function\n- MockVestaboardClientOptions interface defined\n- createMockVestaboardClient() factory function\n- Success/failure mode support in all mocks\n- Message capture capability in HTTP and client mocks\n- getSentMessages() helper methods\n- Pattern matches tests/__mocks__/ai-providers.ts structure\n- Comprehensive JSDoc documentation","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-26T05:24:58.203969257Z","updated_at":"2025-11-26T23:08:42.067493546Z","closed_at":"2025-11-26T23:08:42.067493546Z","dependencies":[{"issue_id":"clack-suz","depends_on_id":"clack-7tb","type":"blocks","created_at":"2025-11-26T05:24:58.204972715Z","created_by":"daemon"},{"issue_id":"clack-suz","depends_on_id":"clack-2jo","type":"parent-child","created_at":"2025-11-26T23:06:05.290281168Z","created_by":"daemon"}]}
{"id":"clack-t51","title":"Update Project Documentation","description":"Update CLAUDE.md with HA client API documentation, architecture diagram, key methods, and usage patterns.","acceptance_criteria":"- CLAUDE.md API Layer section updated\n- HA client in architecture diagram\n- Key methods documented\n- Error types documented\n- Example usage patterns\n- Environment configuration section updated","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T00:19:00.208203547Z","updated_at":"2025-11-25T00:28:39.838666088Z","closed_at":"2025-11-25T00:28:39.838666088Z","dependencies":[{"issue_id":"clack-t51","depends_on_id":"clack-ar9","type":"blocks","created_at":"2025-11-24T00:20:15.948416596Z","created_by":"daemon"},{"issue_id":"clack-t51","depends_on_id":"clack-iwr","type":"blocks","created_at":"2025-11-24T00:20:17.315702638Z","created_by":"daemon"},{"issue_id":"clack-t51","depends_on_id":"clack-2w5","type":"blocks","created_at":"2025-11-24T00:20:18.581072833Z","created_by":"daemon"},{"issue_id":"clack-t51","depends_on_id":"clack-y4k","type":"blocks","created_at":"2025-11-24T00:20:19.886745167Z","created_by":"daemon"},{"issue_id":"clack-t51","depends_on_id":"clack-1wi","type":"blocks","created_at":"2025-11-24T00:20:21.165765876Z","created_by":"daemon"},{"issue_id":"clack-t51","depends_on_id":"clack-p30","type":"blocks","created_at":"2025-11-24T00:20:22.403151126Z","created_by":"daemon"},{"issue_id":"clack-t51","depends_on_id":"clack-3my","type":"parent-child","created_at":"2025-11-24T04:21:00.6916945Z","created_by":"vscode"}]}
{"id":"clack-t9j","title":"Persist Major Updates to Database","description":"Save successful major update content to database after sending to Vestaboard. Also persist failures.\n\n**Files to modify**:\n- `src/content/orchestrator.ts` - Add persistence after successful send\n- `src/content/orchestrator.ts` - Add failure persistence on generation errors\n\n**Implementation**:\n- After successful send: save with status='success', all metadata\n- On failure: save with status='failed', errorType, errorMessage\n- Use fire-and-forget pattern (don't block content delivery)","acceptance_criteria":"- Successful major updates saved to database\n- Failed generations saved with error details\n- Database errors don't block content delivery\n- All metadata fields populated correctly","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-27T21:49:10.605108424Z","updated_at":"2025-11-27T21:49:10.605108424Z","labels":["feature"],"dependencies":[{"issue_id":"clack-t9j","depends_on_id":"clack-kgt","type":"blocks","created_at":"2025-11-27T21:49:32.412572211Z","created_by":"daemon"},{"issue_id":"clack-t9j","depends_on_id":"clack-hfu","type":"parent-child","created_at":"2025-11-27T21:49:45.571119176Z","created_by":"daemon"}]}
{"id":"clack-tya","title":"Account management page with passkey management","description":"Authenticated account page showing profile details, passkey management (add/remove), and logout functionality with mobile-friendly settings layout.","design":"**Account Display:**\n- Profile section (username, email, created date)\n- Passkey list with metadata (device name, last used, created)\n\n**Passkey Management:**\n- \"Add New Passkey\" triggers WebAuthn registration\n- \"Remove Passkey\" with confirmation dialog\n- Rename passkeys\n- Cannot remove last passkey (prevent lockout)\n\n**Backend Endpoints:**\n- GET /api/account/profile\n- POST /api/account/passkey/register/start\n- POST /api/account/passkey/register/verify\n- DELETE /api/account/passkey/:id\n- PATCH /api/account/passkey/:id\n\n**Authorization:**\n- requireAuth middleware on all endpoints\n- Session validation\n- 401 redirect to login","acceptance_criteria":"- [ ] Route protected (redirects if not authenticated)\n- [ ] Profile displays username, email, creation date\n- [ ] Passkey list shows all credentials with metadata\n- [ ] \"Add New Passkey\" triggers WebAuthn registration\n- [ ] User can name new passkeys\n- [ ] \"Remove Passkey\" shows confirmation dialog\n- [ ] Cannot remove last passkey (UI + backend validation)\n- [ ] User can rename passkeys\n- [ ] Logout clears session and redirects\n- [ ] requireAuth middleware validates session\n- [ ] Invalid session returns 401\n- [ ] Rate limiting on account endpoints\n- [ ] Mobile responsive with collapsible sections\n- [ ] 80%+ test coverage","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-26T05:05:08.915925429Z","updated_at":"2025-11-26T05:05:08.915925429Z","labels":["auth","ui","web"],"dependencies":[{"issue_id":"clack-tya","depends_on_id":"clack-dor","type":"parent-child","created_at":"2025-11-26T05:05:21.332468504Z","created_by":"daemon"},{"issue_id":"clack-tya","depends_on_id":"clack-ias","type":"blocks","created_at":"2025-11-26T05:05:30.833980258Z","created_by":"daemon"}]}
{"id":"clack-u7h","title":"Implement Character Code Converter (Pure Functions)","description":"Create character conversion module with lookup table and pure functions to convert text to Vestaboard character codes. No dependencies, 100% unit testable.","design":"## Character Code Mapping (Vestaboard API)\n- Letters A-Z: codes 1-26\n- Numbers 0-9: 0=36, 1-9=27-35\n- Symbols: ! (37), @ (38), # (39), $ (40), etc.\n- Space/Blank: 0\n- Color codes: Red (63), Orange (64), Yellow (65), Green (66), Blue (67), Violet (68), White (69)\n\n## Pure Function Design\nAll functions stateless, deterministic, no side effects.\n\nReferences:\n- https://docs.vestaboard.com/docs/charactercodes/","acceptance_criteria":"- src/api/vestaboard/character-converter.ts created\n- CHARACTER_CODE_MAP constant with complete lookup table\n- textToCharacterCode(char: string): number function\n- rowToCharacterCodes(text: string): number[] function\n- layoutToCharacterCodes(layout: VestaboardLayout): number[][] function\n- isValidCharacter(char: string): boolean function\n- getSupportedCharacters(): Set\u0026lt;string\u0026gt; function\n- Uppercase normalization implemented\n- Unsupported characters throw VestaboardUnsupportedCharacterError\n- No external dependencies (pure module)\n- Exported from src/api/vestaboard/index.ts","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-26T05:24:18.212594627Z","updated_at":"2025-11-26T23:07:07.049186585Z","closed_at":"2025-11-26T23:07:07.049186585Z","dependencies":[{"issue_id":"clack-u7h","depends_on_id":"clack-7tb","type":"blocks","created_at":"2025-11-26T05:24:18.213449294Z","created_by":"daemon"},{"issue_id":"clack-u7h","depends_on_id":"clack-2jo","type":"parent-child","created_at":"2025-11-26T23:06:05.063756709Z","created_by":"daemon"}]}
{"id":"clack-viu","title":"Make AI Generators Functional with Real Data","description":"Three AI generators exist but only MotivationalGenerator works. NewsGenerator and WeatherGenerator claim to use external data (RSS feeds, weather) but no data is ever fetched or injected.\n\n**Approach:**\n- Hybrid pattern: DataProvider for weather, self-fetching for news\n- Multiple news generators (Global, Tech, Local) for equal selection chance\n- ContentDataProvider service for centralized weather/color fetching\n\n**Deliverables:**\n- Working RSSClient with real RSS parsing\n- 3 news generators with category-specific feeds\n- ContentDataProvider service for weather data\n- Updated WeatherGenerator using context data\n- All generators registered and functional","status":"closed","priority":1,"issue_type":"epic","assignee":"claude","created_at":"2025-11-27T09:20:19.481308878Z","updated_at":"2025-11-27T12:11:05.96644201Z","closed_at":"2025-11-27T12:11:05.96644201Z","labels":["ai","content","infrastructure"]}
{"id":"clack-w8p","title":"Register new generators and update prompts","description":"Final integration: register all new generators in ContentRegistry and finalize prompts.\n\n**Files:**\n- `src/content/registry/register-core.ts`\n- `prompts/user/news-global.txt` (verify)\n- `prompts/user/news-tech.txt` (verify)\n- `prompts/user/news-local.txt` (verify)\n- `prompts/user/weather-focus.txt` (verify)\n\n**Requirements:**\n- Register GlobalNewsGenerator, TechNewsGenerator, LocalNewsGenerator at P2\n- Remove old NewsGenerator registration\n- Each news generator gets equal selection probability\n- Verify all prompts reference their injected data sections\n- Update .env.example with new env vars","status":"closed","priority":3,"issue_type":"task","assignee":"claude","created_at":"2025-11-27T09:21:12.218113083Z","updated_at":"2025-11-27T12:08:50.730310628Z","closed_at":"2025-11-27T12:08:50.730310628Z","labels":["content","integration"],"dependencies":[{"issue_id":"clack-w8p","depends_on_id":"clack-viu","type":"parent-child","created_at":"2025-11-27T09:21:53.199653922Z","created_by":"daemon"},{"issue_id":"clack-w8p","depends_on_id":"clack-2n6","type":"blocks","created_at":"2025-11-27T09:22:16.79344371Z","created_by":"daemon"},{"issue_id":"clack-w8p","depends_on_id":"clack-69j","type":"blocks","created_at":"2025-11-27T09:22:18.615464128Z","created_by":"daemon"},{"issue_id":"clack-w8p","depends_on_id":"clack-aqq","type":"blocks","created_at":"2025-11-27T09:22:20.389553337Z","created_by":"daemon"},{"issue_id":"clack-w8p","depends_on_id":"clack-2wk","type":"blocks","created_at":"2025-11-27T09:22:22.968365588Z","created_by":"daemon"}]}
{"id":"clack-wk6","title":"Write Unit Tests for Factory Function","description":"Create unit tests for createVestaboardClient() factory function. Verify proper instantiation, configuration, and dependency injection.","design":"## Test Coverage\nReference: tests/unit/api/ai/factory.test.ts\n\n1. Factory creates client with valid config\n2. Factory validates config (missing apiKey, apiUrl)\n3. Factory applies default values (timeout)\n4. Created client is instance of VestaboardClient\n5. Created client has working methods\n\nSimple tests, minimal mocking needed.","acceptance_criteria":"- tests/unit/api/vestaboard/factory.test.ts created\n- Test createVestaboardClient() with valid config\n- Test factory throws error on missing apiKey\n- Test factory throws error on missing apiUrl\n- Test factory applies default timeout if not provided\n- Test created client is instance of VestaboardClient\n- Test created client implements VestaboardSender interface\n- Test created client has sendLayout method\n- Test created client has sendText method\n- Test created client has validateConnection method\n- 80%+ coverage achieved\n- All tests pass","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-26T05:25:47.920420002Z","updated_at":"2025-11-26T05:25:47.920420002Z","dependencies":[{"issue_id":"clack-wk6","depends_on_id":"clack-nsx","type":"blocks","created_at":"2025-11-26T05:25:47.921243002Z","created_by":"daemon"},{"issue_id":"clack-wk6","depends_on_id":"clack-jc1","type":"blocks","created_at":"2025-11-26T05:25:47.922063585Z","created_by":"daemon"}]}
{"id":"clack-wm7","title":"Add Environment Variables","description":"Add HOME_ASSISTANT_URL, HOME_ASSISTANT_TOKEN, and optional reconnection settings to .env.example with documentation.","acceptance_criteria":"- HOME_ASSISTANT_URL in .env.example\n- HOME_ASSISTANT_TOKEN in .env.example\n- HOME_ASSISTANT_RECONNECT_ATTEMPTS (optional)\n- HOME_ASSISTANT_RECONNECT_DELAY (optional)\n- Token creation documentation in comments\n- Security notes about token storage","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-24T00:18:50.675824584Z","updated_at":"2025-11-24T04:32:05.741542669Z","closed_at":"2025-11-24T04:32:05.741542669Z","dependencies":[{"issue_id":"clack-wm7","depends_on_id":"clack-n94","type":"parent-child","created_at":"2025-11-24T04:19:45.586129882Z","created_by":"vscode"}]}
{"id":"clack-wxg","title":"Create Mocks and Fixtures","description":"Create tests/__mocks__/home-assistant.ts mock factory and tests/fixtures/home-assistant-responses.json with example data.","acceptance_criteria":"- Mock factory in tests/__mocks__/home-assistant.ts\n- Mock connection object\n- Mock subscription functions\n- Fixtures file created\n- Auth success/failure message fixtures\n- Entity state example fixtures\n- Event payload fixtures (automation_triggered, custom)\n- Service call response fixtures\n- Error response fixtures","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-24T00:18:56.039819462Z","updated_at":"2025-11-24T08:56:03.816922097Z","closed_at":"2025-11-24T08:56:03.816922097Z","dependencies":[{"issue_id":"clack-wxg","depends_on_id":"clack-926","type":"parent-child","created_at":"2025-11-24T04:20:22.91119201Z","created_by":"vscode"}]}
{"id":"clack-xcz","title":"Fix TypeScript errors in API route tests after database model type changes","description":"API route tests (voting.test.ts, content.test.ts, logs.test.ts) use string IDs in mock data, but database models changed to expect number IDs (auto-increment). This causes TypeScript compilation errors preventing tests from running.\n\nRoot Cause: Commit 0e6e002 changed VoteRecord.id, ContentRecord.id, LogRecord.id from string to number (database auto-increment), but test mock data was not updated to match.\n\nImpact: 0 tests run (compilation failure blocks all 23 tests)\n\nTypeScript Errors:\n- voting.test.ts:47,77 - Type 'string' not assignable to type 'number' (id: 'vote-123')\n- content.test.ts:47,113 - Type 'string' not assignable to type 'number' (id: 'content-123')  \n- logs.test.ts:47,53,83,180 - Type 'string' not assignable to type 'number' (id: 'log-1')\n\nFiles Affected:\n- tests/web/api-routes/voting.test.ts (2 string IDs)\n- tests/web/api-routes/content.test.ts (2 string IDs)\n- tests/web/api-routes/logs.test.ts (4 string IDs)","design":"Solution: Update test mock data to use numeric IDs matching database model types.\n\nChanges Required:\n- voting.test.ts: 'vote-123' → 123, 'vote-789' → 789\n- content.test.ts: 'content-123' → 123, 'content-1' → 1\n- logs.test.ts: 'log-1' → 1, 'log-2' → 2\n\nEstimated LOC: ~8 lines across 3 test files\nEstimated Time: \u003c15 minutes","acceptance_criteria":"- All TypeScript compilation errors resolved\n- All 23 API route tests run and pass\n- Test coverage maintained at 80%+\n- Linting passes\n- No regression in test functionality","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-11-26T00:28:08.25387847Z","updated_at":"2025-11-26T00:48:38.431533928Z","closed_at":"2025-11-26T00:48:38.431533928Z","labels":["bug","testing","typescript"]}
{"id":"clack-xtg","title":"Task 2.2: Create ModelTierSelector class","description":"Create src/api/ai/model-tier-selector.ts with select() method for tier-based model selection and getAlternate() for cross-provider fallback.","acceptance_criteria":"- ModelTierSelector class with constructor accepting preferred and available providers\n- select(tier) returns provider/model pair\n- getAlternate(current) returns fallback provider/model or null\n- Unit tests with all provider combinations\n- 80%+ coverage","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-26T22:15:11.267591713Z","updated_at":"2025-11-26T23:36:55.625185302Z","closed_at":"2025-11-26T23:36:55.625185302Z","dependencies":[{"issue_id":"clack-xtg","depends_on_id":"clack-adr","type":"parent-child","created_at":"2025-11-26T22:15:18.711013466Z","created_by":"daemon"},{"issue_id":"clack-xtg","depends_on_id":"clack-068","type":"blocks","created_at":"2025-11-26T22:15:18.910753008Z","created_by":"daemon"}]}
{"id":"clack-xu0","title":"Integrate ContentDataProvider into Orchestrator","description":"Wire ContentDataProvider into the content generation pipeline.\n\n**Files:**\n- `src/content/orchestrator.ts`\n- `src/bootstrap.ts`\n- `src/types/content-generator.ts`\n\n**Requirements:**\n- Add `dataProvider` to ContentOrchestratorConfig\n- Call `dataProvider.fetchData()` before generation in `generateAndSend()`\n- Extend `GenerationContext` with `data?: ContentData`\n- Pass pre-fetched data to FrameDecorator (avoid duplicate weather fetch)\n- Update bootstrap to create and wire ContentDataProvider","status":"closed","priority":2,"issue_type":"task","assignee":"claude","created_at":"2025-11-27T09:20:42.544779417Z","updated_at":"2025-11-27T12:08:49.978733961Z","closed_at":"2025-11-27T12:08:49.978733961Z","labels":["infrastructure","orchestrator"],"dependencies":[{"issue_id":"clack-xu0","depends_on_id":"clack-viu","type":"parent-child","created_at":"2025-11-27T09:21:47.279762919Z","created_by":"daemon"},{"issue_id":"clack-xu0","depends_on_id":"clack-yib","type":"blocks","created_at":"2025-11-27T09:22:14.088771792Z","created_by":"daemon"}]}
{"id":"clack-y3q","title":"ColorBarService caching ineffective - new instance created per frame generation","description":"## Problem\n\nEach call to `generateFrame()` creates a new `ColorBarService` instance, making the 24-hour cache ineffective. This causes a ~2.4s AI API call for every frame generation.\n\n## Investigation Findings\n\nPerformance breakdown:\n- Baseline (skip both HA + AI): 237ms\n- With HA only: 820ms (+600ms for WebSocket + state query)\n- With AI only: ~2.6s (+2.4s for AI color generation)\n- With both: ~3s\n\nThe HA connection is fast. The bottleneck is the AI provider call for seasonal colors.\n\n## Root Cause\n\nIn `src/content/frame/frame-generator.ts:54`:\n```typescript\nconst colorService = new ColorBarService(options.aiProvider);\n```\n\nA new instance is created for each frame generation, so the instance-level cache (`private cache: SeasonalColors | null = null`) is never populated from a previous run.\n\n## Impact\n\n- CLI `npm run frame`: 2-3 second delay per run\n- Production major updates: Same ~2.4s delay for each update\n\n## Suggested Fix\n\n1. Make ColorBarService a singleton or inject a shared instance\n2. Or add persistent caching (file/database) that survives instance recreation\n3. Or pre-warm the cache on app startup","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-11-26T19:56:46.268399049Z","updated_at":"2025-11-26T20:29:51.93096526Z","closed_at":"2025-11-26T20:29:51.93096526Z","labels":["caching","performance"]}
{"id":"clack-y4i","title":"Write Unit Tests for Vestaboard Client","description":"Create unit tests for VestaboardClient orchestrator with mocked dependencies (HTTP client and character converter). Target: 80%+ coverage.","design":"## Test Strategy\nUse mock factories from tests/__mocks__/vestaboard.ts\n\nCoverage areas:\n1. sendLayout() delegates to httpClient\n2. sendText() converts then sends\n3. validateConnection() delegates\n4. Error propagation from dependencies\n5. Integration of converter + httpClient\n\nFocus on orchestration logic, not implementation details.","acceptance_criteria":"- tests/unit/api/vestaboard/client.test.ts created\n- Test constructor accepts httpClient and converter dependencies\n- Test sendLayout() calls converter.layoutToCharacterCodes()\n- Test sendLayout() calls httpClient.sendMessage() with converted codes\n- Test sendText() creates layout from text\n- Test sendText() converts and sends\n- Test validateConnection() delegates to httpClient\n- Test error propagation from converter (unsupported character)\n- Test error propagation from httpClient (auth error)\n- Test error propagation from httpClient (connection error)\n- Uses createMockVestaboardHTTPClient() and createMockCharacterConverter()\n- 80%+ coverage achieved\n- All tests pass\n- No real HTTP or character conversion (mocked dependencies)","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-26T05:25:39.497642679Z","updated_at":"2025-11-26T05:25:39.497642679Z","dependencies":[{"issue_id":"clack-y4i","depends_on_id":"clack-745","type":"blocks","created_at":"2025-11-26T05:25:39.498615387Z","created_by":"daemon"},{"issue_id":"clack-y4i","depends_on_id":"clack-suz","type":"blocks","created_at":"2025-11-26T05:25:39.499537262Z","created_by":"daemon"},{"issue_id":"clack-y4i","depends_on_id":"clack-jc1","type":"blocks","created_at":"2025-11-26T05:25:39.500173387Z","created_by":"daemon"}]}
{"id":"clack-y4k","title":"Implement State Query Methods","description":"Implement getState(entityId) for single entity and getAllStates() for all entities, with error handling and response validation.","acceptance_criteria":"- getState(entityId) method\n- getAllStates() method\n- Error handling for invalid entity IDs\n- Response type validation\n- Optional state caching","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-24T00:18:45.991389179Z","updated_at":"2025-11-24T05:49:40.238517254Z","closed_at":"2025-11-24T05:49:40.238517254Z","dependencies":[{"issue_id":"clack-y4k","depends_on_id":"clack-ar9","type":"blocks","created_at":"2025-11-24T00:19:54.357162002Z","created_by":"daemon"},{"issue_id":"clack-y4k","depends_on_id":"clack-4qv","type":"blocks","created_at":"2025-11-24T00:19:55.184396628Z","created_by":"daemon"},{"issue_id":"clack-y4k","depends_on_id":"clack-0nr","type":"parent-child","created_at":"2025-11-24T04:19:07.038716628Z","created_by":"vscode"}]}
{"id":"clack-y91","title":"Implement RSSClient with real RSS parsing","description":"Replace stub RSSClient with working implementation using rss-parser package.\n\n**Files:** `src/api/data-sources/rss.ts`\n\n**Requirements:**\n- npm install rss-parser\n- Implement `fetchFeed()` with actual RSS parsing\n- Implement `getLatestItems()` returning `RSSItem[]`\n- Handle timeouts (10s default) and parse errors gracefully\n- Return empty array on failure (graceful degradation)\n- 80%+ test coverage with mocked HTTP responses","status":"closed","priority":1,"issue_type":"task","assignee":"claude","created_at":"2025-11-27T09:20:30.801671259Z","updated_at":"2025-11-27T10:17:08.833558596Z","closed_at":"2025-11-27T10:17:08.833558596Z","labels":["data-source","infrastructure"],"dependencies":[{"issue_id":"clack-y91","depends_on_id":"clack-viu","type":"parent-child","created_at":"2025-11-27T09:21:46.890863085Z","created_by":"daemon"}]}
{"id":"clack-yib","title":"Create ContentDataProvider service for weather/color aggregation","description":"New service that pre-fetches all external data (weather, colors) before content generation.\n\n**Files:** \n- `src/services/content-data-provider.ts` (new)\n- `src/types/content-data.ts` (new)\n\n**Requirements:**\n- Uses existing `WeatherService` for weather\n- Uses existing `ColorBarService` for colors\n- Parallel fetching with Promise.all\n- Graceful degradation (capture errors in warnings array)\n- Returns `ContentData` with weather, colorBar, fetchedAt, warnings\n- 80%+ test coverage","status":"closed","priority":1,"issue_type":"task","assignee":"claude","created_at":"2025-11-27T09:20:30.931932759Z","updated_at":"2025-11-27T10:27:07.254476428Z","closed_at":"2025-11-27T10:27:07.254476428Z","labels":["infrastructure","weather"],"dependencies":[{"issue_id":"clack-yib","depends_on_id":"clack-viu","type":"parent-child","created_at":"2025-11-27T09:21:47.016836419Z","created_by":"daemon"}]}
{"id":"clack-yun","title":"Task 4.3: Create registerCoreContent function","description":"Create src/content/registry/register-core.ts to register all built-in P2 content generators at application startup.","acceptance_criteria":"- Registers MotivationalGenerator, NewsSummaryGenerator, WeatherFocusGenerator\n- Registers GreetingGenerator, other programmatic generators\n- Registers StaticFallbackGenerator as P3\n- Each with appropriate ContentRegistration metadata","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T22:16:06.221177085Z","updated_at":"2025-11-27T04:11:32.044128803Z","closed_at":"2025-11-27T04:11:32.044128803Z","dependencies":[{"issue_id":"clack-yun","depends_on_id":"clack-4lg","type":"parent-child","created_at":"2025-11-26T22:16:15.346653465Z","created_by":"daemon"},{"issue_id":"clack-yun","depends_on_id":"clack-2tg","type":"blocks","created_at":"2025-11-26T22:16:15.775481881Z","created_by":"daemon"}]}
{"id":"clack-zbb","title":"Task 3.4: Create concrete programmatic generators","description":"Create src/content/generators/programmatic/ with GreetingGenerator (time-based), ASCIIArtGenerator (with color codes), HATemplateGenerator (Jinja templates).","acceptance_criteria":"- GreetingGenerator with morning/afternoon/evening logic\n- ASCIIArtGenerator supporting Vestaboard color codes\n- HATemplateGenerator for Home Assistant Jinja templates\n- Unit tests for each generator","status":"closed","priority":2,"issue_type":"task","assignee":"claude","created_at":"2025-11-26T22:15:39.769038587Z","updated_at":"2025-11-27T03:10:09.822430751Z","closed_at":"2025-11-27T03:10:09.822430751Z","dependencies":[{"issue_id":"clack-zbb","depends_on_id":"clack-6vv","type":"parent-child","created_at":"2025-11-26T22:15:50.536977634Z","created_by":"daemon"},{"issue_id":"clack-zbb","depends_on_id":"clack-6oq","type":"blocks","created_at":"2025-11-26T22:15:51.391799467Z","created_by":"daemon"}]}
{"id":"clack-zoc","title":"Epic 5: Content Orchestrator \u0026 Failover","description":"Coordinate generation pipeline with retry and failover logic. Main orchestrator handles selection, generation, retry (alternate provider), P3 failover, frame decoration, and caching.","status":"closed","priority":1,"issue_type":"epic","assignee":"claude","created_at":"2025-11-26T22:14:24.34007701Z","updated_at":"2025-11-27T05:11:16.766677087Z","closed_at":"2025-11-27T05:11:16.766677087Z","labels":["content-system","failover","orchestrator"],"dependencies":[{"issue_id":"clack-zoc","depends_on_id":"clack-4lg","type":"blocks","created_at":"2025-11-26T22:14:35.353448085Z","created_by":"daemon"}]}
{"id":"clack-zoy","title":"Epic 6: Scheduler \u0026 Event Integration","description":"Integrate with existing event and scheduling infrastructure. Update EventHandler for P0 notifications, MinorUpdateGenerator for cached content, and CronScheduler wiring.","status":"closed","priority":1,"issue_type":"epic","assignee":"claude","created_at":"2025-11-26T22:14:24.625316261Z","updated_at":"2025-11-27T06:06:01.860797719Z","closed_at":"2025-11-27T06:06:01.860797719Z","labels":["content-system","events","scheduler"],"dependencies":[{"issue_id":"clack-zoy","depends_on_id":"clack-zoc","type":"blocks","created_at":"2025-11-26T22:14:35.480003793Z","created_by":"daemon"}]}
{"id":"clack-zrb","title":"Implement rate limiting for API endpoints","description":"Add express-rate-limit middleware to prevent brute force attacks and DoS on API endpoints","design":"Install express-rate-limit and configure:\n- npm install express-rate-limit @types/express-rate-limit\n- Configure per-route rate limits (e.g., 100 requests per 15 minutes)\n- Apply to all /api/* routes\n- Return 429 Too Many Requests with retry-after header\n- Add tests for rate limit enforcement","acceptance_criteria":"- Rate limiting middleware installed and configured\n- API routes return 429 when limit exceeded\n- Retry-After header present in 429 responses\n- Tests verify rate limiting behavior\n- Documentation updated with rate limit policies","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T18:47:55.745019381Z","updated_at":"2025-11-26T04:10:00.545692008Z","closed_at":"2025-11-26T04:10:00.545692008Z","labels":["priority-2","security","web"],"dependencies":[{"issue_id":"clack-zrb","depends_on_id":"clack-ddj","type":"parent-child","created_at":"2025-11-23T23:47:46.511340513Z","created_by":"daemon"},{"issue_id":"clack-zrb","depends_on_id":"clack-a13","type":"related","created_at":"2025-11-23T23:47:52.51929746Z","created_by":"daemon"}]}
